(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12],{"02K0":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default={name:"CommonQuery",props:{queryModel:{type:Object,default:function e(){return{}}},expandQuery:{type:Object,default:function e(){return{}}},expand:{type:Boolean,default:false}},data:function e(){return{expandFlag:false}},watch:{queryModel:function e(){},expand:function e(t){this.expandFlag=t}},methods:{search:function e(){},reset:function e(){this.$emit("reset")},handleExpand:function e(){this.expandFlag=!this.expandFlag;console.log(this.expandFlag)}}}},"8+zq":function(e,t,a){"use strict";var n=function(){var a=this;var e=a.$createElement;var n=a._self._c||e;return n("el-row",{staticClass:"app-container"},[n("CommonQuery",[n("template",{slot:"button1"},[n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{icon:"el-icon-plus",size:"mini",type:"primary"},on:{click:function(e){a.stepCrawlFlag=true}}},[a._v("\n        查看数据\n      ")])],1),a._v(" "),n("template",{slot:"query1"},[n("div",{staticClass:"common-search-wrapper",on:{keyup:function(e){if(!e.type.indexOf("key")&&a._k(e.keyCode,"enter",13,e.key,"Enter")){return null}return a.search(e)}}},[n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:a.queryModel.brandName,expression:"queryModel.brandName"}],attrs:{placeholder:"请输入游戏名称",type:"text"},domProps:{value:a.queryModel.brandName},on:{input:function(e){if(e.target.composing){return}a.$set(a.queryModel,"brandName",e.target.value)}}})]),a._v(" "),n("a",[n("span",{staticClass:"el-icon-search",on:{click:a.search}})])])])],2),a._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:a.listLoading,expression:"listLoading",modifiers:{body:true}}],attrs:{data:a.tableList,height:a.tableHeight,border:"","element-loading-text":"Loading",fit:"","highlight-current-row":""},on:{"selection-change":a.handleSelectionChange}},[n("el-table-column",{attrs:{align:"center",fixed:"",label:"No",type:"index",width:"45"}}),a._v(" "),n("el-table-column",{attrs:{align:"center",label:"电影名称（中文）",prop:"titleChi",width:"100"}}),a._v(" "),n("el-table-column",{attrs:{align:"center",label:"电影名称（原文）",prop:"title",width:"100"}}),a._v(" "),n("el-table-column",{attrs:{align:"center",label:"抓取时间",prop:"timestamp",width:"100"},scopedSlots:a._u([{key:"default",fn:function(e){return[a._v("\n        "+a._s(a.$moment(Number(e.row.timestamp)).format("YYYY-MM-DD HH:mm:ss"))+"\n      ")]}}])}),a._v(" "),n("el-table-column",{attrs:{align:"center",label:"上映时间",prop:"releaseDate"}}),a._v(" "),n("el-table-column",{attrs:{align:"center",label:"平台名称（英文）",prop:"platformEngName"}}),a._v(" "),n("el-table-column",{attrs:{align:"center",label:"平台名称（中文）",prop:"platformChineseName"}}),a._v(" "),n("el-table-column",{attrs:{align:"center",label:"平台类型",prop:"platformType"}}),a._v(" "),n("el-table-column",{attrs:{align:"center",label:"想看数量",prop:"numWantToSee"}}),a._v(" "),n("el-table-column",{attrs:{align:"center",label:"描述",prop:"description"},scopedSlots:a._u([{key:"default",fn:function(t){return[n("el-button",{on:{click:function(e){return a.checkDescription(t)}}},[a._v("查看")])]}}])}),a._v(" "),n("el-table-column",{attrs:{align:"center",label:"想看男性受众占比",prop:"wantToSeeByGenderMale"}}),a._v(" "),n("el-table-column",{attrs:{align:"center",label:"想看女性受众占比",prop:"wantToSeeByGenderFemale"}}),a._v(" "),n("el-table-column",{attrs:{align:"center",label:"想看20岁以下占比",prop:"wantToSeeByAge20"}}),a._v(" "),n("el-table-column",{attrs:{align:"center",label:"想看20到24岁占比",prop:"wantToSeeByAge20To24"}}),a._v(" "),n("el-table-column",{attrs:{align:"center",label:"想看25到29岁占比",prop:"wantToSeeByAge25To29"}}),a._v(" "),n("el-table-column",{attrs:{align:"center",label:"想看30到34岁占比",prop:"wantToSeeByAge30To34"}}),a._v(" "),n("el-table-column",{attrs:{align:"center",label:"想看35到39岁占比",prop:"wantToSeeByAge35To39"}}),a._v(" "),n("el-table-column",{attrs:{align:"center",label:"想看40岁以上占比",prop:"wantToSeeByAge40"}}),a._v(" "),n("el-table-column",{attrs:{align:"center",label:"想看一线城市占比",prop:"wantToSeeByTier1"}}),a._v(" "),n("el-table-column",{attrs:{align:"center",label:"想看二线城市占比",prop:"wantToSeeByTier2"}}),a._v(" "),n("el-table-column",{attrs:{align:"center",label:"想看三线城市占比",prop:"wantToSeeByTier3"}}),a._v(" "),n("el-table-column",{attrs:{align:"center",label:"想看四线城市占比",prop:"wantToSeeByTier4"}})],1),a._v(" "),n("div",{staticClass:"common-pagination-wrapper"},[n("el-pagination",{attrs:{"current-page":a.pagination.page,"page-size":a.pagination.limit,"page-sizes":[10,20,30,50,100],total:a.total,background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){return a.$set(a.pagination,"page",e)},"update:current-page":function(e){return a.$set(a.pagination,"page",e)},"current-change":a.handleCurrentChange,"size-change":a.handleSizeChange}})],1),a._v(" "),n("el-dialog",{attrs:{title:a.textMap[a.dialogStatus],visible:a.oneKeyCrawlFlag,width:"850px"},on:{"update:visible":function(e){a.oneKeyCrawlFlag=e}}},[n("el-row",{attrs:{justify:"center",type:"flex"}},[n("el-col",{attrs:{span:20}},[n("el-form",{ref:"formData",attrs:{model:a.formData,rules:a.rules,"label-position":"right","label-width":"140px"}},[n("el-form-item",{attrs:{label:"爬虫类型",prop:"rewardType"}},[n("el-select",{attrs:{placeholder:""},on:{change:a.chooseRewardType},model:{value:a.formData.rewardType,callback:function(e){a.$set(a.formData,"rewardType",e)},expression:"formData.rewardType"}},a._l(a.settingsList,function(e){return n("el-option",{key:e.code,attrs:{label:e.name,value:e.value}})}),1)],1),a._v(" "),n("el-form-item",{attrs:{label:"爬虫地址",prop:"crawlerAddress"}},[n("el-input",{model:{value:a.formData.crawlerAddress,callback:function(e){a.$set(a.formData,"crawlerAddress",e)},expression:"formData.crawlerAddress"}})],1)],1)],1)],1),a._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],on:{click:function(e){a.oneKeyCrawlFlag=false}}},[a._v(a._s(a.$t("table.cancel")))]),a._v(" "),n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"primary"},on:{click:a.crawlerData}},[a._v(a._s(a.$t("table.confirm")))])],1)],1),a._v(" "),n("el-dialog",{attrs:{title:a.textMap[a.dialogStatus],visible:a.stepCrawlFlag,top:"1vh",width:"1600px"},on:{"update:visible":function(e){a.stepCrawlFlag=e}}},[n("el-row",{attrs:{gutter:1}},[n("el-col",{attrs:{span:2}},[n("el-button",{attrs:{type:"primary"},on:{click:a.getAllCrawlingIndex}},[a._v("\n          "+a._s(a.preSaleWantToSeeListData.length===0?"获取索引":"重新获取索引")+"\n        ")])],1),a._v(" "),n("el-col",{attrs:{span:2}},[!a.crawlingFlag?n("el-button",{attrs:{disabled:a.preSaleWantToSeeListData.length===0,type:"primary"},on:{click:a.beginToCrawRankingListMovieData}},[a._v("\n          "+a._s(a.crawlingCount===0?"开始抓取":"重新抓取")+"\n        ")]):n("el-button",{attrs:{type:"danger"},on:{click:a.stopCrawling}},[a._v("停止抓取")])],1),a._v(" "),n("el-col",{staticStyle:{"text-align":"right"},attrs:{span:20}},[n("el-button",{attrs:{type:"primary"},on:{click:a.save}},[a._v("保存")])],1)],1),a._v(" "),n("el-divider"),a._v(" "),n("el-row",[n("el-col",{attrs:{span:24}},[n("el-row",{attrs:{justify:"left",type:"flex"}},[n("el-col",{attrs:{span:14}},[n("el-input-number",{attrs:{min:0},model:{value:a.rankingListCountLimit,callback:function(e){a.rankingListCountLimit=e},expression:"rankingListCountLimit"}}),a._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:a.handleChangeCounter}},[a._v("确定")])],1),a._v(" "),n("el-col",{attrs:{span:3}})],1),a._v(" "),n("el-row",[n("el-col",{attrs:{span:24}},[n("el-card",{attrs:{shadow:"never"}},[n("el-progress",{attrs:{percentage:a.rankingListData.length!==0?Math.floor(a.crawlingCount/a.rankingListData.length*100):0,"stroke-width":20,"text-inside":true,status:"success"}}),a._v(" "),n("el-divider",[n("el-row",[a.rankingListData.length>0&&a.crawlingCount<a.rankingListData.length?n("el-col",{attrs:{span:24}},[a._v("\n                    共有"+a._s(a.rankingListData.length)+"条数据，正在抓取第"+a._s(a.crawlingCount)+"条...\n                  ")]):n("el-col",{attrs:{span:24}},[a._v("\n                    共有"+a._s(a.rankingListData.length)+"条数据，抓取完毕\n                  ")])],1)],1),a._v(" "),n("el-row",{attrs:{justify:"left",type:"flex"}},[n("el-col",{attrs:{span:24}},[n("el-timeline",{style:a.crawlerStyle},a._l(a.rankingListData.filter(function(e){return!e.disabled}),function(e,t){return n("el-timeline-item",{key:t,staticClass:"timelineitem",attrs:{color:e.color==="success"?"#91d929":"#e4e7ed",timestamp:e.recordTime,placement:"top"}},[n("el-card",{attrs:{shadow:"hover"}},[n("el-row",[n("el-col",{staticStyle:{"text-align":"left"},attrs:{span:1}},[a._v("第"+a._s(t+1)+"条")]),a._v(" "),n("el-col",{staticStyle:{"text-align":"left"},attrs:{span:1}},[a._v(a._s(e.movieId))]),a._v(" "),n("el-col",{staticStyle:{"text-align":"left"},attrs:{span:4}},[a._v(a._s(e.title))]),a._v(" "),n("el-col",{attrs:{span:1}},[a._v("\n                            详情: "),e.detailSuccess===0?n("i",{}):e.detailSuccess===1?n("i",{staticClass:"el-icon-check success"}):n("i",{staticClass:"el-icon-close failed"})]),a._v(" "),n("el-col",{attrs:{span:1}},[a._v("\n                            更多: "),e.moreSectionsSuccess===0?n("i",{}):e.moreSectionsSuccess===1?n("i",{staticClass:"el-icon-check success"}):n("i",{staticClass:"el-icon-close failed"})]),a._v(" "),n("el-col",{attrs:{span:1}},[a._v("\n                            评分: "),e.rankingListRatingSuccess===0?n("i",{}):e.rankingListRatingSuccess===1?n("i",{staticClass:"el-icon-check success"}):n("i",{staticClass:"el-icon-close failed"})]),a._v(" "),n("el-col",{attrs:{span:1}},[a._v("\n                            想看: "),e.rankingListWantToSeePortraitSuccess===0?n("i",{}):e.rankingListWantToSeePortraitSuccess===1?n("i",{staticClass:"el-icon-check success"}):n("i",{staticClass:"el-icon-close failed"})]),a._v(" "),n("el-col",{attrs:{span:2}},[a._v("\n                            首映日票房: "),e.rankingListWantToSeePortraitSuccess===0?n("i",{}):e.rankingListWantToSeePortraitSuccess===1?n("i",{staticClass:"el-icon-check success"}):n("i",{staticClass:"el-icon-close failed"})]),a._v(" "),n("el-col",{attrs:{span:2}},[a._v("\n                            全球票房: "),e.rankingListBoxOfficeGlobalSuccess===0?n("i",{}):e.rankingListBoxOfficeGlobalSuccess===1?n("i",{staticClass:"el-icon-check success"}):n("i",{staticClass:"el-icon-close failed"})])],1)],1)],1)}),1)],1)],1)],1)],1)],1)],1)],1),a._v(" "),n("el-row",{attrs:{justify:"space-between",type:"flex"}},[n("el-col",{attrs:{span:21}}),a._v(" "),n("el-col",{staticStyle:{"text-align":"right"},attrs:{span:3}},[n("el-button",{attrs:{type:"primary"},on:{click:function(e){a.stepCrawlFlag=false}}},[a._v("关闭")])],1)],1)],1)],1)};var i=[];n._withStripped=true;a.d(t,"a",function(){return n});a.d(t,"b",function(){return i})},"8Szl":function(e,t,a){"use strict";var n=a("Mj1t");var i=a.n(n);var r=i.a},EDYP:function(e,t,a){"use strict";var n=function(){var e=this;var t=e.$createElement;var a=e._self._c||t;return a("div",{staticClass:"common-querytable-wrapper"},[a("div",{staticClass:"queryform-wrapper"},[a("div",{staticClass:"outside"},[a("el-form",{staticClass:"basearea"},[a("ul",{staticClass:"pull-left"},[a("li",[e._t("button1")],2)])]),e._v(" "),a("ul",{staticClass:"operation-wrapper pull-right"},[a("li",[e._t("query1")],2),e._v(" "),a("li",[e._t("query2")],2),e._v(" "),a("li",[e._t("query3")],2),e._v(" "),e.expand?a("li",[a("el-button",{staticClass:"expand",attrs:{size:"mini",type:"text"},on:{click:e.handleExpand}},[e._v("高级搜索"),a("i",{staticClass:"el-icon-arrow-down"})])],1):e._e()])],1),e._v(" "),a("div",{staticClass:"expandarea",class:{active:e.expandFlag}},[a("el-form",{ref:"form",attrs:{model:e.queryModel,size:"mini","label-width":"100px"}},[a("el-row",[a("el-col",{attrs:{span:8}},[e._t("query4")],2),e._v(" "),a("el-col",{attrs:{span:8}}),e._v(" "),a("el-col",{attrs:{span:8}})],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:8}}),e._v(" "),a("el-col",{attrs:{span:8}}),e._v(" "),a("el-col",{attrs:{span:8}})],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:23,"pull-right":""}},[a("el-form-item",{staticClass:"pull-right"},[a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-search"},on:{click:e.search}},[e._v("搜索\n              ")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-refresh"},on:{click:e.reset}},[e._v("重置\n              ")])],1)],1)],1)],1)],1)])])};var i=[];n._withStripped=true;a.d(t,"a",function(){return n});a.d(t,"b",function(){return i})},LO5B:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=a("4d7F");var v=d(n);var i=a("P2sY");var w=d(i);var r=a("14Xm");var s=d(r);var o=a("D3Ub");var c=d(o);var l=a("O4qd");var u=d(l);function d(e){return e&&e.__esModule?e:{default:e}}t.default={components:{CommonQuery:u.default},data:function e(){var a=this;return{getListByPaginationRequest:"crawlerMaoyanRankingList/getListByPagination",crawlAndSaveRequest:"crawlerMaoyanRankingList/crawlAndSave",crawlRankinglistDetailRequest:"crawlerMaoyanRankingList/crawlRankinglistDetail",crawlRankingListMoreSectionsRequest:"crawlerMaoyanRankingList/crawlRankingListMoreSections",crawlRankingListRatingRequest:"crawlerMaoyanRankingList/crawlRankingListRating",crawlRankingListWantToSeePortraitRequest:"crawlerMaoyanRankingList/crawlRankingListWantToSeePortrait",crawlRankingListBoxOfficeBoxPremiereRequest:"crawlerMaoyanRankingList/crawlRankingListBoxOfficeBoxPremiere",crawlRankingListBoxOfficeGlobalRequest:"crawlerMaoyanRankingList/crawlRankingListBoxOfficeGlobal",crawlMoviePreSaleDetailRequest:"crawlerMaoyanPreSale/crawlMoviePreSaleDetail",crawlMoviePreSalePortraitRequest:"crawlerMaoyanPreSale/crawlMoviePreSalePortrait",deleteRecordRequest:"crawlerMaoyanRankingList/deleteRecords",getSettingsRequest:"settings/getList",crawlRankingListByYearRequest:"crawlerMaoyanRankingList/crawlRankingListByYear",crawlPreSaleMovieListRequest:"crawlerMaoyanPreSale/crawlMovieList",saveMultipleMaoyanRankingListRecordRequest:"crawlerMaoyanRankingList/saveMultipleMaoyanRankingListRecord",crawlerSettingFlag:false,crawlerSetting:{address:""},chosenReward:"",chooseRewardTypeModel:{},chosenThirdPartyProductInfo:{},value2:"",value1:"",dailyLimitMode:"",limitMode:"",tableKey:0,tableList:[],total:null,listLoading:true,availabilityFlag:false,statusDictionary:[{code:0,name:"未上线"},{code:1,name:"上线"}],queryModel:{sort:"desc",brandName:""},pagination:{page:1,limit:100},importanceOptions:[1,2,3],sortOptions:[{label:"ID Ascending",key:"+id"},{label:"ID Descending",key:"-id"}],statusOptions:["published","draft","deleted"],showReviewer:false,formData:{headerCode:"maoyan",crawlerAddress:""},dialogFormVisible:false,dialogStatus:"",textMap:{update:"Edit",create:"Create"},dialogPvVisible:false,rules:{id:[{required:true,message:"此项为必填项",trigger:"change"}],description:[{required:true,message:"此项为必填项",trigger:"change"}],name:[{required:true,message:"此项为必填项",trigger:"change"}],dailyLimit:[{required:true,message:"此项为必填项",trigger:"change"}],limit:[{required:true,message:"此项为必填项",trigger:"change"}],startDate:[{required:true,message:"此项为必填项",trigger:"change"}],endDate:[{required:true,message:"此项为必填项",trigger:"change"}],status:[{required:true,message:"此项为必填项",trigger:"change"}]},downloadLoading:false,pickerOptions0:{disabledDate:function e(t){if(a.value2!==""){return t.getTime()>a.value2}}},pickerOptions1:{disabledDate:function e(t){return t.getTime()<a.value1}},fileList:[],portraitParams:{bucketName:"funyvalley",folderName:"icon"},iosVersionListData:[],androidVersionListData:[],searchTxt:"",expandQuery:"",showFileListFlag:false,newFile:"",advertisementDialogFlag:false,currentAdvertisementTabIndex:0,effectiveDuration:[],multipleSelection:[],oneKeyCrawlFlag:false,stepCrawlFlag:false,settingsList:[],rankingListMovieData:[],rankingListData:[],crawlingCount:0,preSaleWantToSeeListData:[],preSaleWantToSeeListMovieData:[],crawlingFlag:false,rankingListCountLimit:0,presaleCountLimit:0}},computed:{tableHeight:function e(){return this.$store.state.app.tableHeight},dictionaryList:function e(){return this.$store.state.app.dictionary.crawlerAddress},crawlerStyle:function e(){return{height:this.tableHeight-180+"px",overflow:"auto"}}},watch:{effectiveDuration:function e(t){console.log(t);if(t===null){t=[]}this.formData.startDate=this.$moment(t[0]).format("YYYY-MM-DD");this.formData.endDate=this.$moment(t[1]).format("YYYY-MM-DD")},currentAdvertisementTabIndex:function e(t){console.log(t)}},mounted:function e(){var a=this;return(0,c.default)(s.default.mark(function e(){return s.default.wrap(function e(t){while(1){switch(t.prev=t.next){case 0:t.next=2;return a.getSettingsDictionary();case 2:a.settingsList=t.sent;a.getTableData();case 4:case"end":return t.stop()}}},e,a)}))()},methods:{getTableData:function e(){var t=this;this.listLoading=true;this.$http.get(this.$baseUrl+this.getListByPaginationRequest,{params:(0,w.default)(this.queryModel,this.pagination)}).then(function(e){console.log("getListByPaginationRequest",e);var a=[];e.data.forEach(function(e,t){a.push({titleChi:e.titleChi,title:e.title,timestamp:e.timestamp,numWantToSee:e.numWantToSee,releaseDate:e.releaseDate,platformEngName:e.platformEngName,platformChineseName:e.platformChineseName,platformType:e.platformType,wantToSeeByGenderMale:e.wantToSeeByGenderMale,wantToSeeByGenderFemale:e.wantToSeeByGenderFemale,wantToSeeByAge20:e.wantToSeeByAge20,wantToSeeByAge20To24:e.wantToSeeByAge20To24,wantToSeeByAge25To29:e.wantToSeeByAge25To29,wantToSeeByAge30To34:e.wantToSeeByAge30To34,wantToSeeByAge35To39:e.wantToSeeByAge35To39,wantToSeeByAge40:e.wantToSeeByAge40,wantToSeeByTier1:e.wantToSeeByTier1,wantToSeeByTier2:e.wantToSeeByTier2,wantToSeeByTier3:e.wantToSeeByTier3,wantToSeeByTier4:e.wantToSeeByTier4})});console.log("getTableData+++++",e);t.tableList=a;t.total=e.pagination.total;t.listLoading=false})},getSettingsDictionary:function e(){var n=this;return new v.default(function(t,a){n.$http.get(n.$baseUrl+n.getSettingsRequest,{params:{type:"crawlerAddress"}}).then(function(e){t(e.data)}).catch(function(e){console.log(e);a(e)})})},handleFilter:function e(){this.pagination.page=1;this.getTableData()},handleSizeChange:function e(t){this.pagination.limit=t;this.getTableData()},handleCurrentChange:function e(t){this.pagination.page=t;this.getTableData()},resetTemp:function e(){this.formData={id:"",description:"",rewardImage:"",rewardName:"",rewardPrompt:"",rewardStr:"",rewardType:"",rewardValue:"",status:""}},crawlerData:function e(){var t=this;this.$http.post(this.$baseUrl+this.crawlAndSaveRequest,{address:this.formData.crawlerAddress,headerCode:this.formData.headerCode}).then(function(e){console.log(e);t.$message.success("抓取成功");t.getTableData();t.oneKeyCrawlFlag=false})},createData:function e(){this.formData.id="";this.updateData()},handleUpdate:function e(t){var a=this;console.log(t);this.formData=(0,w.default)({},t.row);this.dialogStatus="update";this.dialogFormVisible=true;this.$nextTick(function(){a.$refs["formData"].clearValidate()})},updateData:function e(){var t=this;this.$refs["formData"].validate(function(e){if(e){t.$http.post(t.$baseUrl+t.addAndUpdateRewardInfoRequest,{id:t.formData.id,description:t.formData.description,rewardImage:t.formData.rewardImage,rewardName:t.formData.rewardName,rewardPrompt:t.formData.rewardPrompt,rewardStr:t.formData.rewardStr,rewardType:t.formData.rewardType,rewardValue:t.formData.rewardValue,status:t.formData.status}).then(function(e){console.log(e);t.dialogFormVisible=false;t.$message.success("信息修改成功");t.getTableData()}).catch(function(e){console.log(e);t.$message.error(e.response.status.toString()+"  "+e.response.data.error)})}})},handleSelectionChange:function e(t){this.multipleSelection=t;console.log(t)},handleMultipleDelete:function e(){var t=this;this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.deleteRecord(t.multipleSelection.map(function(e){return e.id}))}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleDelete:function e(t){var a=this;console.log(t);this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.deleteRecord([t.row.id])}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},deleteRecord:function e(t){var a=this;this.$http.delete(this.$baseUrl+this.deleteRecordRequest,{data:{id:t}}).then(function(e){console.log(e);a.dialogFormVisible=false;a.$message.success("删除成功");a.getTableData()}).catch(function(e){console.log(e);a.$message.error(e.response.status.toString()+"  "+e.response.data.error)})},expand:function e(){this.expandQuery=!this.expandQuery},search:function e(){this.getTableData()},reset:function e(){this.queryModel.available=true},uploadSuccess1:function e(t){console.log(t);this.formData.icon=t.url},uploadSuccess2:function e(t){this.formData.rewardImage=t.url},changeDailyLimitMode:function e(t){this.formData.dailyLimit=t.toString()==="unlimited"?"-1":this.formData.dailyLimit},changeLimitMode:function e(t){this.formData.limit=t.toString()==="unlimited"?"-1":this.formData.limit;alert(this.formData.limit)},chooseRewardType:function e(t){this.formData.type=this.settingsList.filter(function(e){return e.value===t})[0].code;this.formData.crawlerAddress=t},chooseThirdPartyProduct:function e(t){this.chosenThirdPartyProductInfo=t},confirmCrawlerSetting:function e(){this.crawlerSettingFlag=false;this.$message.success("设置成功")},focusSortList:function e(t,n){var i=this;this.loading=true;this.$http.get(this.$baseUrl+this.queryRewardProductByNameRequest,{params:{name:this.chosenReward}}).then(function(e){console.log(e);i.loading=false;var a=[];if(e.data.length!==0){e.data.forEach(function(e,t){a.push((0,w.default)(e,{value:e.name}))});console.log(111,a);n(a)}})},getAllCrawlingIndex:function e(){var t=this;var a=this.getRankingList();var n=this.getPreSaleList();v.default.all([a,n]).then(function(e){console.log(e)}).catch(function(e){console.log(e);t.$message.error(e)})},getMovieData:function e(){var t=this;var a=this.getDetailData();v.default.all([a]).then(function(e){console.log(e)}).catch(function(e){console.log(e);t.$message.error(e)})},getDetailData:function e(){var n=this;return(0,c.default)(s.default.mark(function e(){return s.default.wrap(function e(t){while(1){switch(t.prev=t.next){case 0:return t.abrupt("return",new v.default(function(t,a){n.$http.get(n.$baseUrl+n.crawlPreSaleMovieListRequest,{params:{address:"https://piaofang.maoyan.com/store",headerCode:"maoyanPreSale"}}).then(function(e){console.log(e);n.presaleCountLimit=e.data.length;n.preSaleWantToSeeListData=e.data;e.data.forEach(function(e,t){if(t<n.presaleCountLimit){n.$set(n.preSaleWantToSeeListData,t,(0,w.default)(e,{detailSuccess:0,content:["detailSuccess","rankingListWantToSeePortraitSuccess"],color:"sunccess",recordTime:"---",active:true}))}});n.$message.success("获取预售列表成功");t(n.preSaleWantToSeeListData)}).catch(function(e){n.$message.error(e);a(e)})}));case 1:case"end":return t.stop()}}},e,n)}))()},getPreSaleList:function e(){var a=this;return(0,c.default)(s.default.mark(function e(){return s.default.wrap(function e(t){while(1){switch(t.prev=t.next){case 0:a.$http.get(a.$baseUrl+a.crawlPreSaleMovieListRequest,{params:{address:"https://piaofang.maoyan.com/store",headerCode:"maoyanPreSale"}}).then(function(e){console.log(e);a.presaleCountLimit=e.data.length;a.preSaleWantToSeeListData=e.data;a.preSaleWantToSeeListData.forEach(function(e,t){if(t<a.presaleCountLimit){a.$set(a.preSaleWantToSeeListData,t,(0,w.default)(e,{preSaleWantToSeePortraitSuccess:0,content:"detailSuccess"+"preSaleWantToSeePortraitSuccess",color:"sunccess",recordTime:"---",active:true}))}});a.$message.success("获取预售列表成功")}).catch(function(e){a.$message.error(e)});case 1:case"end":return t.stop()}}},e,a)}))()},getRankingList:function e(){var n=this;return(0,c.default)(s.default.mark(function e(){return s.default.wrap(function e(t){while(1){switch(t.prev=t.next){case 0:return t.abrupt("return",new v.default(function(t,a){n.$http.post(n.$baseUrl+n.crawlRankingListByYearRequest,{address:"https://piaofang.maoyan.com/rankings/year",headerCode:"maoyanRankingList",limit:n.rankingListCountLimit,query:{year:"2019",tab:"1"}},{timeout:2e4}).then(function(e){n.rankingListCountLimit=e.data.length;console.log(e);n.rankingListData=e.data;e.data.forEach(function(e,t){n.$set(n.rankingListData,t,(0,w.default)(e,{title:e.title,detailSuccess:0,rankingListRatingSuccess:0,rankingListWantToSeePortraitSuccess:0,moreSectionsSuccess:0,rankingListBoxOfficeGlobalSuccess:0,content:"detailSuccess"+"rankingListWantToSeePortraitSuccess",color:"sunccess",recordTime:"---",active:true}))});t(n.rankingListData);n.$message.success("获取电影排名列表成功")}).catch(function(e){n.$message.error(e);a(e)})}));case 1:case"end":return t.stop()}}},e,n)}))()},beginToCrawRankingListMovieData:function e(){var h=this;return(0,c.default)(s.default.mark(function e(){var a,m,n,i,r;return s.default.wrap(function e(t){while(1){switch(t.prev=t.next){case 0:h.crawlingCount=0;h.rankingListMovieData=[];a=[];m={};n=false;i=false;r=function t(){var n=h.crawlingCount;h.crawlingFlag=true;console.log(h.rankingListData);var i=h.rankingListData[n].movieId;var e=function e(){return new v.default(function(t,a){h.$http.get(h.$baseUrl+h.crawlRankinglistDetailRequest,{params:{address:"https://piaofang.maoyan.com/movie/"+i,headerCode:"rankingListDetailHeader"},timeout:2e4}).then(function(e){m.detail=e.data;h.$set(h.rankingListData,n,(0,w.default)(h.rankingListData[n],{detailSuccess:1}));t(e.data)}).catch(function(e){h.$set(h.rankingListData,n,(0,w.default)(h.rankingListData[n],{detailSuccess:2}));a(e)})})};var a=function e(){return new v.default(function(t,a){h.$http.get(h.$baseUrl+h.crawlRankingListMoreSectionsRequest,{params:{address:"https://piaofang.maoyan.com/movie/"+i+"/moresections",headerCode:"rankingListDetailHeader"}}).then(function(e){m.detailMoreSections=e.data;h.$set(h.rankingListData,n,(0,w.default)(h.rankingListData[n],{moreSectionsSuccess:1}));t(e.data)}).catch(function(e){h.$set(h.rankingListData,n,(0,w.default)(h.rankingListData[n],{moreSectionsSuccess:2}));a(e)})})};var r=function e(){return new v.default(function(t,a){h.$http.get(h.$baseUrl+h.crawlRankingListWantToSeePortraitRequest,{params:{address:"https://piaofang.maoyan.com/movie/"+i+"/wantindex?wkwebview=1%26city_tier=0%26city_id=0%26cityName=%E5%85%A8%E5%9B%BD",headerCode:"rankingListDetailHeader"},timeout:2e4}).then(function(e){m.portrait=e.data;console.log("getRankingListWantToSeePortrait",e.data);h.$set(h.rankingListData,n,(0,w.default)(h.rankingListData[n],{rankingListWantToSeePortraitSuccess:1}));t(e.data)}).catch(function(e){h.$set(h.rankingListData,n,(0,w.default)(h.rankingListData[n],{rankingListWantToSeePortraitSuccess:2}));a(e)})})};var s=function e(){return new v.default(function(t,a){h.$http.get(h.$baseUrl+h.crawlRankingListRatingRequest,{params:{address:"https://piaofang.maoyan.com/movie/"+i+"/audienceRating?usePageCache=true",headerCode:"rankingListDetailHeader"},timeout:3e5}).then(function(e){m.rating=e.data;h.$set(h.rankingListData,n,(0,w.default)(h.rankingListData[n],{rankingListRatingSuccess:1}));t(e.data)}).catch(function(e){h.$set(h.rankingListData,n,(0,w.default)(h.rankingListData[n],{rankingListRatingSuccess:2}));a(e)})})};var o=function e(){return new v.default(function(t,a){h.$http.get(h.$baseUrl+h.crawlRankingListBoxOfficeBoxPremiereRequest,{params:{address:"https://piaofang.maoyan.com/movie/"+i+"/premierebox",headerCode:"rankingListDetailHeader"},timeout:3e5}).then(function(e){m.rating=e.data;h.$set(h.rankingListData,n,(0,w.default)(h.rankingListData[n],{RankingListPemiereBoxSuccess:1}));t(e.data)}).catch(function(e){h.$set(h.rankingListData,n,(0,w.default)(h.rankingListData[n],{RankingListPemiereBoxSuccess:2}));a(e)})})};var l=function e(){return new v.default(function(t,a){h.$http.get(h.$baseUrl+h.crawlRankingListBoxOfficeGlobalRequest,{params:{address:"https://piaofang.maoyan.com/movie/"+i+"/boxshowna",headerCode:"rankingListDetailHeader"},timeout:3e5}).then(function(e){m.rating=e.data;h.$set(h.rankingListData,n,(0,w.default)(h.rankingListData[n],{rankingListBoxOfficeGlobalSuccess:1}));t(e.data)}).catch(function(e){h.$set(h.rankingListData,n,(0,w.default)(h.rankingListData[n],{rankingListBoxOfficeGlobalSuccess:2}));a(e)})})};var c=e();var u=r();var d=s();var g=a();var f=o();var p=l();v.default.all([c,g,d,u,f,p]).then(function(e){console.log("responseAll",e);h.rankingListData[n].color="success";h.$set(h.rankingListMovieData,n,(0,w.default)(e[0],e[1],e[2],e[3],e[4],e[5]));console.log("rankingListMovieData",h.rankingListMovieData);if(h.crawlingCount===h.rankingListCountLimit){h.crawlingFlag=false;h.crawlingCount=0}else{h.crawlingCount++}if(h.crawlingFlag){h.rankingListData[n].recordTime=h.$moment(Date.now()).format("hh:mm:ss");t()}}).catch(function(e){console.log(e);if(h.crawlingCount===h.rankingListData.length){h.crawlingFlag=false}else{h.crawlingCount++}if(h.crawlingFlag){t()}})};r();case 8:case"end":return t.stop()}}},e,h)}))()},beginToCrawlPreSale:function e(){var l=this;return(0,c.default)(s.default.mark(function e(){var a,o,n,i,r;return s.default.wrap(function e(t){while(1){switch(t.prev=t.next){case 0:l.crawlingCount=0;l.preSaleWantToSeeListData=[];a=[];o={};n=false;i=false;r=function t(){var n=l.crawlingCount;l.crawlingFlag=true;var i=l.preSaleWantToSeeListData[n].movieId;var e=function e(){return new v.default(function(t,a){l.$http.get(l.$baseUrl+l.crawlMoviePreSaleDetailRequest,{params:{address:"https://piaofang.maoyan.com/movie/"+i,headerCode:"maoyanPreSale"}}).then(function(e){o.detail=e.data;l.$set(l.preSaleWantToSeeListData,n,(0,w.default)(l.preSaleWantToSeeListData[n],{detailSuccess:1}));t(e.data)}).catch(function(e){l.$set(l.preSaleWantToSeeListData,n,(0,w.default)(l.preSaleWantToSeeListData[n],{detailSuccess:2}));a(e)})})};var a=function e(){return new v.default(function(t,a){l.$http.get(l.$baseUrl+l.crawlMoviePreSalePortraitRequest,{params:{address:"https://piaofang.maoyan.com/movie/"+i+"/wantindex?wkwebview=1%26city_tier=0%26city_id=0%26cityName=%E5%85%A8%E5%9B%BD",headerCode:"rankingListDetailHeader"}}).then(function(e){o.portrait=e.data;l.$set(l.preSaleWantToSeeListData,n,(0,w.default)(l.preSaleWantToSeeListData[n],{rankingListWantToSeePortraitSuccess:1,color:"success"}));t(e.data)}).catch(function(e){l.$set(l.preSaleWantToSeeListData,n,(0,w.default)(l.preSaleWantToSeeListData[n],{rankingListWantToSeePortraitSuccess:2,color:"failed"}));a(e)})})};var r=e();var s=a();if(l.crawlingCount===l.rankingListCountLimit){l.crawlingFlag=false}else{l.crawlingCount++}v.default.all([r,s]).then(function(e){console.log(e);l.$set(l.preSaleWantToSeeListData,n,(0,w.default)(e[0],e[1]));console.log("rankingListMovieData",l.preSaleWantToSeeListData);if(l.crawlingFlag){l.preSaleWantToSeeListData[n].recordTime=l.$moment(Date.now()).format("hh:mm:ss");t()}}).catch(function(e){console.log(e);if(l.crawlingCount===l.rankingListCountLimit){l.crawlingFlag=false}else{l.crawlingCount++}if(l.crawlingFlag){t()}})};r();case 8:case"end":return t.stop()}}},e,l)}))()},stopCrawling:function e(){this.crawlingFlag=false},save:function e(){var t=this;if(this.crawlingCount===this.rankingListCountLimit){console.log(this.rankingListMovieData);debugger;this.$http.post(this.$baseUrl+this.saveMultipleMaoyanRankingListRecordRequest,this.rankingListMovieData.reverse()).then(function(e){t.$message.success("数据提交成功");t.getTableData();t.stepCrawlFlag=false})}else{this.$message.warning("dsdsdsdsds")}},handleChangeCounter:function e(t){var a=this;this.preSaleWantToSeeListData.forEach(function(e,t){a.$set(a.preSaleWantToSeeListData,t,(0,w.default)(a.preSaleWantToSeeListData[t],{active:t<a.rankingListCountLimit}))})},checkDescription:function e(t){this.$alert(t.row.description,"电影描述",{confirmButtonText:"关闭",closeOnClickModal:true,callback:function e(t){}})}}}},Mj1t:function(e,t,a){if(false){var n}},O4qd:function(e,t,a){"use strict";a.r(t);var n=a("EDYP");var i=a("vPuT");for(var r in i)if(r!=="default")(function(e){a.d(t,e,function(){return i[e]})})(r);var s=a("KHd+");var o=Object(s["a"])(i["default"],n["a"],n["b"],false,null,"63580e73",null);if(false){var l}o.options.__file="src/views/common/CommonQuery.vue";t["default"]=o.exports},Oo7i:function(e,t,a){"use strict";a.r(t);var n=a("LO5B");var i=a.n(n);for(var r in n)if(r!=="default")(function(e){a.d(t,e,function(){return n[e]})})(r);t["default"]=i.a},nTqp:function(e,t,a){"use strict";a.r(t);var n=a("8+zq");var i=a("Oo7i");for(var r in i)if(r!=="default")(function(e){a.d(t,e,function(){return i[e]})})(r);var s=a("8Szl");var o=a("KHd+");var l=Object(o["a"])(i["default"],n["a"],n["b"],false,null,null,null);if(false){var c}l.options.__file="src/views/crawling/MaoyanRankingListWantToSeeList.vue";t["default"]=l.exports},vPuT:function(e,t,a){"use strict";a.r(t);var n=a("02K0");var i=a.n(n);for(var r in n)if(r!=="default")(function(e){a.d(t,e,function(){return n[e]})})(r);t["default"]=i.a}}]);