(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{"02K0":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default={name:"CommonQuery",props:{queryModel:{type:Object,default:function e(){return{}}},expandQuery:{type:Object,default:function e(){return{}}},expand:{type:Boolean,default:false}},data:function e(){return{expandFlag:false}},watch:{queryModel:function e(){},expand:function e(t){this.expandFlag=t}},methods:{search:function e(){},reset:function e(){this.$emit("reset")},handleExpand:function e(){this.expandFlag=!this.expandFlag;console.log(this.expandFlag)}}}},"1eM0":function(e,t,a){"use strict";var r=function(){var a=this;var e=a.$createElement;var r=a._self._c||e;return r("el-row",{staticClass:"app-container"},[r("CommonQuery",[r("template",{slot:"button1"},[r("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{icon:"el-icon-plus",size:"mini",type:"primary"},on:{click:function(e){a.stepCrawlFlag=true}}},[a._v("\n        分步抓取\n      ")]),a._v(" "),r("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{icon:"el-icon-delete",size:"mini",type:"danger"},on:{click:a.handleMultipleDelete}},[a._v("\n        批量删除\n      ")])],1),a._v(" "),r("template",{slot:"query1"},[r("div",{staticClass:"common-search-wrapper",on:{keyup:function(e){if(!e.type.indexOf("key")&&a._k(e.keyCode,"enter",13,e.key,"Enter")){return null}return a.search(e)}}},[r("label",[r("input",{directives:[{name:"model",rawName:"v-model",value:a.queryModel.brandName,expression:"queryModel.brandName"}],attrs:{placeholder:"请输入游戏名称",type:"text"},domProps:{value:a.queryModel.brandName},on:{input:function(e){if(e.target.composing){return}a.$set(a.queryModel,"brandName",e.target.value)}}})]),a._v(" "),r("a",[r("span",{staticClass:"el-icon-search",on:{click:a.search}})])])])],2),a._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:a.listLoading,expression:"listLoading",modifiers:{body:true}}],attrs:{data:a.tableList,height:a.tableHeight,border:"","element-loading-text":"Loading",fit:"","highlight-current-row":""},on:{"selection-change":a.handleSelectionChange}},[r("el-table-column",{attrs:{fixed:"left",type:"selection",width:"30"}}),a._v(" "),r("el-table-column",{attrs:{align:"center",fixed:"",label:"No",type:"index",width:"45"}}),a._v(" "),r("el-table-column",{attrs:{align:"center",label:"movieId",prop:"movieId",width:"100"}}),a._v(" "),r("el-table-column",{attrs:{align:"center",label:"电影名称（中文）",prop:"titleChi",width:"100"}}),a._v(" "),r("el-table-column",{attrs:{align:"center",label:"电影名称（原文）",prop:"title",width:"100"}}),a._v(" "),r("el-table-column",{attrs:{align:"center",label:"抓取时间",prop:"timestamp",width:"100"},scopedSlots:a._u([{key:"default",fn:function(e){return[a._v("\n        "+a._s(a.$moment(Number(e.row.timestamp)).format("YYYY-MM-DD HH:mm:ss"))+"\n      ")]}}])}),a._v(" "),r("el-table-column",{attrs:{align:"center",label:"上映时间",prop:"releaseDate"}}),a._v(" "),r("el-table-column",{attrs:{align:"center",label:"平台名称（英文）",prop:"platformEngName"}}),a._v(" "),r("el-table-column",{attrs:{align:"center",label:"平台名称（中文）",prop:"platformChineseName"}}),a._v(" "),r("el-table-column",{attrs:{align:"center",label:"平台类型",prop:"platformType"}}),a._v(" "),r("el-table-column",{attrs:{align:"center",label:"想看数量",prop:"numWantToSee"}}),a._v(" "),r("el-table-column",{attrs:{align:"center",label:"想看男性受众占比",prop:"wantToSeeByGenderMale"}}),a._v(" "),r("el-table-column",{attrs:{align:"center",label:"想看女性受众占比",prop:"wantToSeeByGenderFemale"}}),a._v(" "),r("el-table-column",{attrs:{align:"center",label:"想看20岁以下占比",prop:"wantToSeeByAge20"}}),a._v(" "),r("el-table-column",{attrs:{align:"center",label:"想看20到24岁占比",prop:"wantToSeeByAge20To24"}}),a._v(" "),r("el-table-column",{attrs:{align:"center",label:"想看25到29岁占比",prop:"wantToSeeByAge25To29"}}),a._v(" "),r("el-table-column",{attrs:{align:"center",label:"想看30到34岁占比",prop:"wantToSeeByAge30To34"}}),a._v(" "),r("el-table-column",{attrs:{align:"center",label:"想看35到39岁占比",prop:"wantToSeeByAge35To39"}}),a._v(" "),r("el-table-column",{attrs:{align:"center",label:"想看40岁以上占比",prop:"wantToSeeByAge40"}}),a._v(" "),r("el-table-column",{attrs:{align:"center",label:"想看一线城市占比",prop:"wantToSeeByTier1"}}),a._v(" "),r("el-table-column",{attrs:{align:"center",label:"想看二线城市占比",prop:"wantToSeeByTier2"}}),a._v(" "),r("el-table-column",{attrs:{align:"center",label:"想看三线城市占比",prop:"wantToSeeByTier3"}}),a._v(" "),r("el-table-column",{attrs:{align:"center",label:"想看四线城市占比",prop:"wantToSeeByTier4"}}),a._v(" "),r("el-table-column",{attrs:{align:"center",label:"预售票房",prop:"premiereBoxInfo"}}),a._v(" "),r("el-table-column",{attrs:{align:"center",label:"预售排片占比",prop:"premiereShowRate"}}),a._v(" "),r("el-table-column",{attrs:{align:"center",label:"预售排片场次",prop:"premiereShowRate"}}),a._v(" "),r("el-table-column",{attrs:{align:"center",fixed:"right",label:"操作",width:"70px"},scopedSlots:a._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(e){return a.handleDelete(t)}}},[a._v("删除")])]}}])})],1),a._v(" "),r("div",{staticClass:"common-pagination-wrapper"},[r("el-pagination",{attrs:{"current-page":a.pagination.page,"page-size":a.pagination.limit,"page-sizes":[10,20,30,50,100],total:a.total,background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){return a.$set(a.pagination,"page",e)},"update:current-page":function(e){return a.$set(a.pagination,"page",e)},"current-change":a.handleCurrentChange,"size-change":a.handleSizeChange}})],1),a._v(" "),r("el-dialog",{attrs:{title:a.textMap[a.dialogStatus],visible:a.oneKeyCrawlFlag,width:"850px"},on:{"update:visible":function(e){a.oneKeyCrawlFlag=e}}},[r("el-row",{attrs:{justify:"center",type:"flex"}},[r("el-col",{attrs:{span:20}},[r("el-form",{ref:"formData",attrs:{model:a.formData,rules:a.rules,"label-position":"right","label-width":"140px"}},[r("el-form-item",{attrs:{label:"爬虫类型",prop:"rewardType"}},[r("el-select",{attrs:{placeholder:""},on:{change:a.chooseRewardType},model:{value:a.formData.rewardType,callback:function(e){a.$set(a.formData,"rewardType",e)},expression:"formData.rewardType"}},a._l(a.settingsList,function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.value}})}),1)],1),a._v(" "),r("el-form-item",{attrs:{label:"爬虫地址",prop:"crawlerAddress"}},[r("el-input",{model:{value:a.formData.crawlerAddress,callback:function(e){a.$set(a.formData,"crawlerAddress",e)},expression:"formData.crawlerAddress"}})],1)],1)],1)],1),a._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{directives:[{name:"waves",rawName:"v-waves"}],on:{click:function(e){a.oneKeyCrawlFlag=false}}},[a._v(a._s(a.$t("table.cancel")))]),a._v(" "),r("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"primary"},on:{click:a.crawlerData}},[a._v(a._s(a.$t("table.confirm")))])],1)],1),a._v(" "),r("el-dialog",{attrs:{title:a.textMap[a.dialogStatus],visible:a.stepCrawlFlag,top:"1vh",width:"1600px"},on:{"update:visible":function(e){a.stepCrawlFlag=e}}},[r("el-row",{attrs:{gutter:1}},[r("el-col",{attrs:{span:4}},[r("el-button",{attrs:{type:"primary"},on:{click:function(e){a.prepareToCrawlFlag=true}}},[a._v("\n          "+a._s(a.preSaleListData.length===0?"获取索引":"重新获取索引")+"\n        ")]),a._v(" "),!a.crawlingFlag?r("el-button",{attrs:{disabled:a.preSaleListData.length===0,type:"primary"},on:{click:a.beginToCrawPreSaleListMovieData}},[a._v("\n          "+a._s(a.crawlingCount===0?"开始抓取":"重新抓取")+"\n        ")]):r("el-button",{attrs:{type:"danger"},on:{click:a.stopCrawling}},[a._v("停止抓取")])],1),a._v(" "),r("el-col",{staticStyle:{"text-align":"right"},attrs:{span:20}},[r("el-button",{attrs:{type:"primary"},on:{click:a.save}},[a._v("保存")])],1)],1),a._v(" "),r("el-divider"),a._v(" "),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-row",{attrs:{justify:"left",type:"flex"}},[r("el-col",{attrs:{span:5}},[r("el-input-number",{attrs:{min:0},model:{value:a.preSaleListCountLimit,callback:function(e){a.preSaleListCountLimit=e},expression:"preSaleListCountLimit"}}),a._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:a.handleChangeCounter}},[a._v("确定")])],1),a._v(" "),r("el-col",{attrs:{span:19}},[r("el-progress",{attrs:{percentage:a.preSaleListData.length!==0?Math.floor(a.crawlingCount/a.preSaleListData.filter(function(e){return e.active}).length*100):0,"stroke-width":20,"text-inside":true,status:"success"}})],1)],1),a._v(" "),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-card",{attrs:{shadow:"never"}},[r("el-divider",[r("el-row",[a.preSaleListData.length>0&&a.crawlingCount<a.preSaleListData.length?r("el-col",{attrs:{span:24}},[a._v("\n                    共有"+a._s(a.preSaleListData.length)+"条数据，正在抓取第"+a._s(a.crawlingCount)+"条...\n                  ")]):r("el-col",{attrs:{span:24}},[a._v("\n                    共有"+a._s(a.preSaleListData.length)+"条数据，抓取完毕\n                  ")])],1)],1),a._v(" "),r("el-row",{attrs:{justify:"left",type:"flex"}},[r("el-col",{attrs:{span:24}},[r("el-timeline",{style:a.crawlerStyle},a._l(a.preSaleListData.filter(function(e){return e.active}),function(e,t){return r("el-timeline-item",{key:t,staticClass:"timelineitem",attrs:{color:e.color==="success"?"#91d929":"#e4e7ed",timestamp:e.recordTime,placement:"top"}},[r("el-card",{attrs:{shadow:"hover"}},[r("el-row",[r("el-col",{staticStyle:{"text-align":"left"},attrs:{span:1}},[a._v("第"+a._s(t+1)+"条\n                          ")]),a._v(" "),r("el-col",{staticStyle:{"text-align":"left"},attrs:{span:4}},[a._v(a._s(e.title)+"\n                          ")]),a._v(" "),r("el-col",{attrs:{span:2}},[a._v("\n                            详情: "),e.detailSuccess===0?r("i",{}):e.detailSuccess===1?r("i",{staticClass:"el-icon-check success"}):r("i",{staticClass:"el-icon-close failed"})]),a._v(" "),r("el-col",{attrs:{span:2}},[a._v("\n                            想看画像: "),e.portraitSuccess===0?r("i",{}):e.portraitSuccess===1?r("i",{staticClass:"el-icon-check success"}):r("i",{staticClass:"el-icon-close failed"})]),a._v(" "),r("el-col",{attrs:{span:2}},[a._v("\n                            预售票房: "),e.premiereSuccess===0?r("i",{}):e.premiereSuccess===1?r("i",{staticClass:"el-icon-check success"}):r("i",{staticClass:"el-icon-close failed"})]),a._v(" "),r("el-col",{attrs:{span:2}},[a._v("\n                            预售票房明细: "),e.bookingDetailsSuccess===0?r("i",{}):e.bookingDetailsSuccess===1?r("i",{staticClass:"el-icon-check success"}):r("i",{staticClass:"el-icon-close failed"})])],1)],1)],1)}),1)],1)],1)],1)],1)],1)],1)],1),a._v(" "),r("el-row",{attrs:{justify:"space-between",type:"flex"}},[r("el-col",{attrs:{span:21}}),a._v(" "),r("el-col",{staticStyle:{"text-align":"right"},attrs:{span:3}},[r("el-button",{attrs:{type:"primary"},on:{click:function(e){a.stepCrawlFlag=false}}},[a._v("关闭")])],1)],1)],1),a._v(" "),r("el-dialog",{attrs:{visible:a.prepareToCrawlFlag,title:"准备爬取",width:"600px"},on:{"update:visible":function(e){a.prepareToCrawlFlag=e}}},[r("el-radio-group",{on:{change:a.handleChangeLimitType},model:{value:a.crawlerCountType,callback:function(e){a.crawlerCountType=e},expression:"crawlerCountType"}},[r("el-radio",{attrs:{label:0}},[a._v("全部")]),a._v(" "),r("el-radio",{attrs:{label:1}},[a._v("部分")]),a._v(" "),r("el-input-number",{attrs:{disabled:a.crawlerCountType===0,min:0},on:{change:a.handleChangeCountLimit},model:{value:a.preSaleListCountLimit,callback:function(e){a.preSaleListCountLimit=e},expression:"preSaleListCountLimit"}})],1),a._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:a.getAllCrawlingIndex}},[a._v("开始抓取列表")])],1)],1)};var l=[];r._withStripped=true;a.d(t,"a",function(){return r});a.d(t,"b",function(){return l})},"3lAF":function(e,t,a){"use strict";var r=a("Xp0e");var l=a.n(r);var n=l.a},"7Cgf":function(e,t,a){"use strict";a.r(t);var r=a("1eM0");var l=a("k0RL");for(var n in l)if(n!=="default")(function(e){a.d(t,e,function(){return l[e]})})(n);var i=a("3lAF");var s=a("KHd+");var o=Object(s["a"])(l["default"],r["a"],r["b"],false,null,null,null);if(false){var c}o.options.__file="src/views/crawling/MaoyanPreSale.vue";t["default"]=o.exports},EDYP:function(e,t,a){"use strict";var r=function(){var e=this;var t=e.$createElement;var a=e._self._c||t;return a("div",{staticClass:"common-querytable-wrapper"},[a("div",{staticClass:"queryform-wrapper"},[a("div",{staticClass:"outside"},[a("el-form",{staticClass:"basearea"},[a("ul",{staticClass:"pull-left"},[a("li",[e._t("button1")],2)])]),e._v(" "),a("ul",{staticClass:"operation-wrapper pull-right"},[a("li",[e._t("query1")],2),e._v(" "),a("li",[e._t("query2")],2),e._v(" "),a("li",[e._t("query3")],2),e._v(" "),e.expand?a("li",[a("el-button",{staticClass:"expand",attrs:{size:"mini",type:"text"},on:{click:e.handleExpand}},[e._v("高级搜索"),a("i",{staticClass:"el-icon-arrow-down"})])],1):e._e()])],1),e._v(" "),a("div",{staticClass:"expandarea",class:{active:e.expandFlag}},[a("el-form",{ref:"form",attrs:{model:e.queryModel,size:"mini","label-width":"100px"}},[a("el-row",[a("el-col",{attrs:{span:8}},[e._t("query4")],2),e._v(" "),a("el-col",{attrs:{span:8}}),e._v(" "),a("el-col",{attrs:{span:8}})],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:8}}),e._v(" "),a("el-col",{attrs:{span:8}}),e._v(" "),a("el-col",{attrs:{span:8}})],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:23,"pull-right":""}},[a("el-form-item",{staticClass:"pull-right"},[a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-search"},on:{click:e.search}},[e._v("搜索\n              ")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-refresh"},on:{click:e.reset}},[e._v("重置\n              ")])],1)],1)],1)],1)],1)])])};var l=[];r._withStripped=true;a.d(t,"a",function(){return r});a.d(t,"b",function(){return l})},O4qd:function(e,t,a){"use strict";a.r(t);var r=a("EDYP");var l=a("vPuT");for(var n in l)if(n!=="default")(function(e){a.d(t,e,function(){return l[e]})})(n);var i=a("KHd+");var s=Object(i["a"])(l["default"],r["a"],r["b"],false,null,"63580e73",null);if(false){var o}s.options.__file="src/views/common/CommonQuery.vue";t["default"]=s.exports},Xp0e:function(e,t,a){if(false){var r}},k0RL:function(e,t,a){"use strict";a.r(t);var r=a("s+FT");var l=a.n(r);for(var n in r)if(n!=="default")(function(e){a.d(t,e,function(){return r[e]})})(n);t["default"]=l.a},"s+FT":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=a("4d7F");var g=d(r);var l=a("P2sY");var h=d(l);var n=a("14Xm");var i=d(n);var s=a("D3Ub");var o=d(s);var c=a("O4qd");var u=d(c);function d(e){return e&&e.__esModule?e:{default:e}}t.default={components:{CommonQuery:u.default},data:function e(){return{getListByPaginationRequest:"crawlerMaoyanPreSale/getListByPagination",crawlAndSaveRequest:"crawlerMaoyanPreSale/crawlAndSave",crawlPreSaleDetailRequest:"crawlerMaoyanPreSale/crawlPreSaleDetail",crawlPreSaleWantToSeePortraitRequest:"crawlerMaoyanPreSale/crawlPreSaleWantToSeePortrait",crawlPreSaleBoxOfficePremiereRequest:"crawlerMaoyanPreSale/crawlPreSaleBoxOfficePremiere",crawlPreSaleBookingDetailsRequest:"crawlerMaoyanPreSale/crawlPreSaleBookingDetails",deleteRecordRequest:"crawlerMaoyanPreSale/deleteRecords",getSettingsRequest:"settings/getList",crawlMovieListRequest:"crawlerMaoyanPreSale/crawlMovieList",saveMultipleMaoyanPreSaleRequest:"crawlerMaoyanPreSale/saveMultipleMaoyanPreSale",saveMultipleMaoyanPreSaleBookingDetailsRequest:"crawlerMaoyanPreSale/saveMultipleMaoyanPreSaleBookingDetails",crawlerSettingFlag:false,crawlerSetting:{address:""},chosenReward:"",chooseRewardTypeModel:{},chosenThirdPartyProductInfo:{},value2:"",value1:"",dailyLimitMode:"",limitMode:"",tableKey:0,tableData:[{date:"2016-05-02",name:"王小虎",address:"上海市普陀区金沙江路 1518 弄"},{date:"2016-05-04",name:"王小虎",address:"上海市普陀区金沙江路 1517 弄"},{date:"2016-05-01",name:"王小虎",address:"上海市普陀区金沙江路 1519 弄"},{date:"2016-05-03",name:"王小虎",address:"上海市普陀区金沙江路 1516 弄"}],tableList:[],total:null,listLoading:true,availabilityFlag:false,statusDictionary:[{code:0,name:"未上线"},{code:1,name:"上线"}],queryModel:{sort:"desc",brandName:""},pagination:{page:1,limit:100},importanceOptions:[1,2,3],sortOptions:[{label:"ID Ascending",key:"+id"},{label:"ID Descending",key:"-id"}],statusOptions:["published","draft","deleted"],showReviewer:false,formData:{rewardType:"",crawlerAddress:""},dialogFormVisible:false,dialogStatus:"",textMap:{update:"Edit",create:"Create"},dialogPvVisible:false,rules:{id:[{required:true,message:"此项为必填项",trigger:"change"}],description:[{required:true,message:"此项为必填项",trigger:"change"}],name:[{required:true,message:"此项为必填项",trigger:"change"}],dailyLimit:[{required:true,message:"此项为必填项",trigger:"change"}],limit:[{required:true,message:"此项为必填项",trigger:"change"}],startDate:[{required:true,message:"此项为必填项",trigger:"change"}],endDate:[{required:true,message:"此项为必填项",trigger:"change"}],status:[{required:true,message:"此项为必填项",trigger:"change"}]},fileList:[],searchTxt:"",expandQuery:"",crawlerCountType:0,currentAdvertisementTabIndex:0,effectiveDuration:[],multipleSelection:[],oneKeyCrawlFlag:false,stepCrawlFlag:false,prepareToCrawlFlag:false,settingsList:[],preSaleData:[],crawlingCount:0,preSaleListData:[],bookingDetailsData:[],crawlingFlag:false,preSaleListCountLimit:0}},computed:{tableHeight:function e(){return this.$store.state.app.tableHeight},dictionaryList:function e(){return this.$store.state.app.dictionary.crawlerAddress},crawlerStyle:function e(){return{height:this.tableHeight-180+"px",overflow:"auto"}}},watch:{effectiveDuration:function e(t){console.log(t);if(t===null){t=[]}this.formData.startDate=this.$moment(t[0]).format("YYYY-MM-DD");this.formData.endDate=this.$moment(t[1]).format("YYYY-MM-DD")},currentAdvertisementTabIndex:function e(t){console.log(t)}},mounted:function e(){var a=this;return(0,o.default)(i.default.mark(function e(){return i.default.wrap(function e(t){while(1){switch(t.prev=t.next){case 0:a.getTableData();case 1:case"end":return t.stop()}}},e,a)}))()},methods:{getTableData:function e(){var t=this;this.listLoading=true;this.queryModel=(0,h.default)(this.queryModel,this.pagination);this.$http.get(this.$baseUrl+this.getListByPaginationRequest,{params:this.queryModel}).then(function(e){console.log("getListByPaginationRequest",e);t.tableList=e.data;t.total=e.pagination.total;t.listLoading=false})},getSettingsDictionary:function e(){var r=this;return new g.default(function(t,a){r.$http.get(r.$baseUrl+r.getSettingsRequest,{params:{type:"crawlerAddress"}}).then(function(e){t(e.data)}).catch(function(e){console.log(e);a(e)})})},handleFilter:function e(){this.pagination.page=1;this.getTableData()},handleSizeChange:function e(t){this.pagination.limit=t;this.getTableData()},handleCurrentChange:function e(t){this.pagination.page=t;this.getTableData()},resetTemp:function e(){this.formData={id:"",description:"",rewardImage:"",rewardName:"",rewardPrompt:"",rewardStr:"",rewardType:"",rewardValue:"",status:"....."}},crawlerData:function e(){var t=this;this.$http.post(this.$baseUrl+this.crawlAndSaveRequest,{address:this.formData.crawlerAddress,headerCode:this.formData.headerCode}).then(function(e){console.log(e);t.$message.success("抓取成功");t.getTableData();t.oneKeyCrawlFlag=false})},createData:function e(){this.formData.id="";this.updateData()},handleUpdate:function e(t){var a=this;console.log(t);this.formData=(0,h.default)({},t.row);this.dialogStatus="update";this.dialogFormVisible=true;this.$nextTick(function(){a.$refs["formData"].clearValidate()})},updateData:function e(){var t=this;this.$refs["formData"].validate(function(e){if(e){t.$http.post(t.$baseUrl+t.addAndUpdateRewardInfoRequest,{id:t.formData.id,description:t.formData.description,rewardImage:t.formData.rewardImage,rewardName:t.formData.rewardName,rewardPrompt:t.formData.rewardPrompt,rewardStr:t.formData.rewardStr,rewardType:t.formData.rewardType,rewardValue:t.formData.rewardValue,status:t.formData.status}).then(function(e){console.log(e);t.dialogFormVisible=false;t.$message.success("信息修改成功");t.getTableData()}).catch(function(e){console.log(e);t.$message.error(e.response.status.toString()+"  "+e.response.data.error)})}})},handleSelectionChange:function e(t){this.multipleSelection=t;console.log(t)},handleMultipleDelete:function e(){var t=this;this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){console.log("this.multipleSelection+++++",t.multipleSelection);t.deleteRecord(t.multipleSelection.map(function(e){return{id:e.id,movieId:e.movieId,timestamp:e.timestamp}}))}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleDelete:function e(t){var a=this;console.log(t);this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.deleteRecord([t.row.movieId])}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},deleteRecord:function e(t){var a=this;this.$http.delete(this.$baseUrl+this.deleteRecordRequest,{data:{selections:t}}).then(function(e){console.log(e);a.dialogFormVisible=false;a.$message.success("删除成功");a.getTableData()}).catch(function(e){console.log(e);a.$message.error(e.response.status.toString()+"  "+e.response.data.error)})},expand:function e(){this.expandQuery=!this.expandQuery},search:function e(){this.getTableData()},reset:function e(){this.queryModel.available=true},uploadSuccess1:function e(t){console.log(t);this.formData.icon=t.url},uploadSuccess2:function e(t){this.formData.rewardImage=t.url},changeDailyLimitMode:function e(t){this.formData.dailyLimit=t.toString()==="unlimited"?"-1":this.formData.dailyLimit},changeLimitMode:function e(t){this.formData.limit=t.toString()==="unlimited"?"-1":this.formData.limit;alert(this.formData.limit)},chooseRewardType:function e(t){this.formData.type=this.settingsList.filter(function(e){return e.value===t})[0].code;this.formData.crawlerAddress=t},chooseThirdPartyProduct:function e(t){this.chosenThirdPartyProductInfo=t},confirmCrawlerSetting:function e(){this.crawlerSettingFlag=false;this.$message.success("设置成功")},focusSortList:function e(t,r){var l=this;this.loading=true;this.$http.get(this.$baseUrl+this.queryRewardProductByNameRequest,{params:{name:this.chosenReward}}).then(function(e){console.log(e);l.loading=false;var a=[];if(e.data.length!==0){e.data.forEach(function(e,t){a.push((0,h.default)(e,{value:e.name}))});console.log(111,a);r(a)}})},getAllCrawlingIndex:function e(){var a=this;return(0,o.default)(i.default.mark(function e(){return i.default.wrap(function e(t){while(1){switch(t.prev=t.next){case 0:a.prepareToCrawlFlag=false;a.$http.get(a.$baseUrl+a.crawlMovieListRequest,{params:{address:"https://piaofang.maoyan.com/store",headerCode:"maoyanPreSale",limit:a.preSaleListCountLimit}}).then(function(e){console.log(e);a.preSaleListCountLimit=e.data.length;a.preSaleListData=e.data;a.preSaleListData.forEach(function(e,t){if(t<a.preSaleListCountLimit){a.$set(a.preSaleListData,t,(0,h.default)(e,{detailSuccess:0,portraitSuccess:0,premiereSuccess:0,bookingDetailsSuccess:0,content:"detailSuccess"+"portraitSuccess",color:"sunccess",recordTime:"---",active:true}))}});a.$message.success("获取列表成功")}).catch(function(e){a.$message.error(e)});case 2:case"end":return t.stop()}}},e,a)}))()},beginToCrawPreSaleListMovieData:function e(){var m=this;return(0,o.default)(i.default.mark(function e(){var d,p,f,a;return i.default.wrap(function e(t){while(1){switch(t.prev=t.next){case 0:m.crawlingCount=0;m.preSaleData=[];m.preSaleListData.forEach(function(e,t){m.$set(m.preSaleListData,t,(0,h.default)(e,{detailSuccess:0,portraitSuccess:0,premiereSuccess:0,bookingDetailsSuccess:0}))});d=m.preSaleListData.filter(function(e){return e.active});p={};f=Date.now();a=function t(){var r=m.crawlingCount;m.crawlingFlag=true;var l=d[r].movieId;var e=function e(){return new g.default(function(t,a){m.$http.get(m.$baseUrl+m.crawlPreSaleDetailRequest,{params:{address:"https://piaofang.maoyan.com/movie/"+l,headerCode:"maoyanPreSale"}}).then(function(e){p.detail=e.data;m.$set(m.preSaleListData,r,(0,h.default)(d[r],{detailSuccess:1}));t(e.data)}).catch(function(e){m.$set(m.preSaleListData,r,(0,h.default)(d[r],{detailSuccess:2}));a(e)})})};var a=function e(){return new g.default(function(t,a){m.$http.get(m.$baseUrl+m.crawlPreSaleWantToSeePortraitRequest,{params:{address:"https://piaofang.maoyan.com/movie/"+l,headerCode:"maoyanPreSalePortrait"}}).then(function(e){p.portrait=e.data;m.$set(m.preSaleListData,r,(0,h.default)(d[r],{portraitSuccess:1,color:"success"}));t(e.data)}).catch(function(e){m.$set(m.preSaleListData,r,(0,h.default)(d[r],{portraitSuccess:2,color:"failed"}));a(e)})})};var n=function e(){return new g.default(function(t,a){m.$http.get(m.$baseUrl+m.crawlPreSaleBoxOfficePremiereRequest,{params:{address:"https://piaofang.maoyan.com/movie/"+l+"/premierebox",headerCode:"maoyanPreSalePortrait"}}).then(function(e){p.portrait=e.data;m.$set(m.preSaleListData,r,(0,h.default)(d[r],{premiereSuccess:1,color:"success"}));t(e.data)}).catch(function(e){m.$set(m.preSaleListData,r,(0,h.default)(d[r],{premiereSuccess:2,color:"failed"}));a(e)})})};var i=function e(){return new g.default(function(t,a){m.$http.get(m.$baseUrl+m.crawlPreSaleBookingDetailsRequest,{params:{movieId:l,headerCode:"maoyanPreSalePortrait"}}).then(function(e){p.portrait=e.data;m.$set(m.preSaleListData,r,(0,h.default)(d[r],{bookingDetailsSuccess:1,color:"success"}));t(e.data)}).catch(function(e){m.$set(m.preSaleListData,r,(0,h.default)(d[r],{bookingDetailsSuccess:2,color:"failed"}));a(e)})})};var s=e();var o=a();var c=n();var u=i();g.default.all([s,o,c,u]).then(function(e){console.log(e);m.$set(m.preSaleData,r,(0,h.default)({movieId:l,timestamp:f},e[0],e[1],e[2]));m.$set(m.bookingDetailsData,r,{movieId:l,timestamp:f,list:e[3].map(function(e){return(0,h.default)(e,{timestamp:f})})});m.crawlingCount++;if(m.crawlingCount===m.preSaleListCountLimit){m.crawlingFlag=false}console.log("preSaleData",m.preSaleData);if(m.crawlingFlag){m.preSaleListData[r].recordTime=m.$moment(Date.now()).format("hh:mm:ss");t()}}).catch(function(e){console.log(e);if(m.crawlingCount===m.preSaleListCountLimit){m.crawlingFlag=false}else{m.crawlingCount++}if(m.crawlingFlag){t()}})};a();case 8:case"end":return t.stop()}}},e,m)}))()},stopCrawling:function e(){this.crawlingFlag=false},save:function e(){var t=this;if(this.crawlingCount===this.preSaleListCountLimit){console.log("this.preSaleData+++++",this.preSaleData);var a=this.$http.post(this.$baseUrl+this.saveMultipleMaoyanPreSaleRequest,this.preSaleData);var r=this.$http.post(this.$baseUrl+this.saveMultipleMaoyanPreSaleBookingDetailsRequest,this.bookingDetailsData);g.default.all([a,r]).then(function(e){t.getTableData();t.stepCrawlFlag=false;t.$message.success("数据提交成功")}).catch(function(e){t.$message.warning(e)})}else{}},handleChangeLimitType:function e(t){console.log(this.crawlerCountType);if(this.crawlerCountType===0){this.preSaleListCountLimit=0}},handleChangeCountLimit:function e(){},handleChangeCounter:function e(t){var a=this;this.preSaleListData.forEach(function(e,t){a.$set(a.preSaleListData,t,(0,h.default)(a.preSaleListData[t],{active:t<a.preSaleListCountLimit}))});console.log("this.preSaleListData+++",this.preSaleListData)}}}},vPuT:function(e,t,a){"use strict";a.r(t);var r=a("02K0");var l=a.n(r);for(var n in r)if(n!=="default")(function(e){a.d(t,e,function(){return r[e]})})(n);t["default"]=l.a}}]);