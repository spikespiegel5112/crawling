(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5ced5d2e"],{"4b70":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",{staticClass:"app-container"},[a("CommonQuery",[a("template",{slot:"button1"},[a("el-row",[a("el-col",{attrs:{span:24}},[a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{icon:"el-icon-plus",size:"mini",type:"primary"},on:{click:function(t){e.stepCrawlFlag=!0}}},[e._v(" 分步抓取 ")]),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{icon:"el-icon-delete",size:"mini",type:"danger"},on:{click:e.handleMultipleDelete}},[e._v(" 批量删除 ")])],1),a("el-col",{attrs:{span:12}})],1)],1),a("template",{slot:"quicksearch"},[a("div",{staticClass:"common_search_wrapper",on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search.apply(null,arguments)}}},[a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.queryModel.brandName,expression:"queryModel.brandName"}],attrs:{placeholder:"请输入游戏名称",type:"text"},domProps:{value:e.queryModel.brandName},on:{input:function(t){t.target.composing||e.$set(e.queryModel,"brandName",t.target.value)}}})]),a("a",[a("span",{staticClass:"el-icon-search",on:{click:e.search}})])])])],2),a("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],attrs:{data:e.tableList,height:e.tableHeight,border:"","element-loading-text":"Loading",fit:"","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{fixed:"left",type:"selection",width:"40"}}),a("el-table-column",{attrs:{align:"center",fixed:"",label:"No",type:"index",width:"45"}}),a("el-table-column",{attrs:{align:"center",label:"电影名称（中文）",prop:"titleChi",width:"100"}}),a("el-table-column",{attrs:{align:"center",label:"电影名称（原文）",prop:"title",width:"100"}}),a("el-table-column",{attrs:{align:"center",label:"抓取时间",prop:"timestamp",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.$moment(Number(t.row.timestamp)).format("YYYY-MM-DD HH:mm:ss"))+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"上映时间",prop:"releaseDate"}}),a("el-table-column",{attrs:{align:"center",label:"平台名称（英文）",prop:"platformEngName"}}),a("el-table-column",{attrs:{align:"center",label:"平台名称（中文）",prop:"platformChineseName"}}),a("el-table-column",{attrs:{align:"center",label:"平台类型",prop:"platformType"}}),a("el-table-column",{attrs:{align:"center",label:"想看数量",prop:"numWantToSee"}}),a("el-table-column",{attrs:{align:"center",label:"评分人数",prop:"numOfRating"}}),a("el-table-column",{attrs:{align:"center",label:"描述",prop:"description"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{on:{click:function(a){return e.checkDescription(t)}}},[e._v("查看")])]}}])}),a("el-table-column",{attrs:{align:"center",label:"总评分",prop:"rating"}}),a("el-table-column",{attrs:{align:"center",label:"评分1到2分占比",prop:"rating1To2"}}),a("el-table-column",{attrs:{align:"center",label:"评分4到4分占比",prop:"rating3To4"}}),a("el-table-column",{attrs:{align:"center",label:"评分5到6分占比",prop:"rating5To6"}}),a("el-table-column",{attrs:{align:"center",label:"评分7到8分占比",prop:"rating7To8"}}),a("el-table-column",{attrs:{align:"center",label:"评分9到10分占比",prop:"rating9To10"}}),a("el-table-column",{attrs:{align:"center",label:"评分20岁以下占比",prop:"ratingByAge20"}}),a("el-table-column",{attrs:{align:"center",label:"评分20到24岁占比",prop:"ratingByAge20To24"}}),a("el-table-column",{attrs:{align:"center",label:"评分25到29岁占比",prop:"ratingByAge25To29"}}),a("el-table-column",{attrs:{align:"center",label:"评分30到34岁占比",prop:"ratingByAge30To34"}}),a("el-table-column",{attrs:{align:"center",label:"评分35到39岁占比",prop:"ratingByAge35To39"}}),a("el-table-column",{attrs:{align:"center",label:"评分一线城市占比",prop:"ratingByTier1"}}),a("el-table-column",{attrs:{align:"center",label:"评分二线城市占比",prop:"ratingByTier2"}}),a("el-table-column",{attrs:{align:"center",label:"评分三线城市占比",prop:"ratingByTier3"}}),a("el-table-column",{attrs:{align:"center",label:"评分四线城市占比",prop:"ratingByTier4"}}),a("el-table-column",{attrs:{align:"center",label:"想看男性受众占比",prop:"wantToSeeByGenderMale"}}),a("el-table-column",{attrs:{align:"center",label:"想看女性受众占比",prop:"wantToSeeByGenderFemale"}}),a("el-table-column",{attrs:{align:"center",label:"想看20岁以下占比",prop:"wantToSeeByAge20"}}),a("el-table-column",{attrs:{align:"center",label:"想看20到24岁占比",prop:"wantToSeeByAge20To24"}}),a("el-table-column",{attrs:{align:"center",label:"想看25到29岁占比",prop:"wantToSeeByAge25To29"}}),a("el-table-column",{attrs:{align:"center",label:"想看30到34岁占比",prop:"wantToSeeByAge30To34"}}),a("el-table-column",{attrs:{align:"center",label:"想看35到39岁占比",prop:"wantToSeeByAge35To39"}}),a("el-table-column",{attrs:{align:"center",label:"想看40岁以上占比",prop:"wantToSeeByAge40"}}),a("el-table-column",{attrs:{align:"center",label:"想看一线城市占比",prop:"wantToSeeByTier1"}}),a("el-table-column",{attrs:{align:"center",label:"想看二线城市占比",prop:"wantToSeeByTier2"}}),a("el-table-column",{attrs:{align:"center",label:"想看三线城市占比",prop:"wantToSeeByTier3"}}),a("el-table-column",{attrs:{align:"center",label:"想看四线城市占比",prop:"wantToSeeByTier4"}}),a("el-table-column",{attrs:{align:"center",label:"预售票房",prop:"preSaleBoxInfo"}}),a("el-table-column",{attrs:{align:"center",label:"预售排片占比",prop:"preSaleShowRate"}}),a("el-table-column",{attrs:{align:"center",label:"预售排片场次",prop:"preSaleShowInfo"}}),a("el-table-column",{attrs:{align:"center",label:"全球票房（美元）",prop:"globalBoxInfo"}}),a("el-table-column",{attrs:{align:"center",label:"北美票房（美元）",prop:"northAmericaBoxInfo"}}),a("el-table-column",{attrs:{align:"center",label:"IMDb评分",prop:"imdbRating"}}),a("el-table-column",{attrs:{align:"center",label:"平均上座率",prop:"avgSeatView"}}),a("el-table-column",{attrs:{align:"center",label:"平均上映率",prop:"avgShowView"}}),a("el-table-column",{attrs:{align:"center",label:"平均观看率",prop:"avgViewBox"}}),a("el-table-column",{attrs:{align:"center",label:"票房数",prop:"boxInfo"}}),a("el-table-column",{attrs:{align:"center",label:"票房占有率",prop:"boxRate"}}),a("el-table-column",{attrs:{align:"center",label:"myRefundNumInfo",prop:"myRefundNumInfo"}}),a("el-table-column",{attrs:{align:"center",label:"myRefundRateInfo",prop:"myRefundRateInfo"}}),a("el-table-column",{attrs:{align:"center",label:"在线票房比率",prop:"onlineBoxRate"}}),a("el-table-column",{attrs:{align:"center",label:"退款数",prop:"refundViewInfo"}}),a("el-table-column",{attrs:{align:"center",label:"退款率",prop:"refundViewRate"}}),a("el-table-column",{attrs:{align:"center",label:"上映时间",prop:"releaseInfo"}}),a("el-table-column",{attrs:{align:"center",label:"上映时间颜色",prop:"releaseInfoColor"}}),a("el-table-column",{attrs:{align:"center",label:"上座率",prop:"seatRate"}}),a("el-table-column",{attrs:{align:"center",label:"平均上座率",prop:"showInfo"}}),a("el-table-column",{attrs:{align:"center",label:"上映率",prop:"showRate"}}),a("el-table-column",{attrs:{align:"center",label:"分账票房",prop:"splitAvgViewBox"}}),a("el-table-column",{attrs:{align:"center",label:"splitBoxInfo",prop:"splitBoxInfo"}}),a("el-table-column",{attrs:{align:"center",label:"分账比率",prop:"splitBoxRate"}}),a("el-table-column",{attrs:{align:"center",label:"总分账信息",prop:"splitSumBoxInfo"}}),a("el-table-column",{attrs:{align:"center",label:"总票房",prop:"sumBoxInfo"}}),a("el-table-column",{attrs:{align:"center",label:"viewInfo",prop:"viewInfo"}}),a("el-table-column",{attrs:{align:"center",label:"viewInfo",prop:"viewInfoV2"}}),a("el-table-column",{attrs:{align:"center",fixed:"right",label:"操作",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t)}}},[e._v("删除")])]}}])})],1),a("div",{staticClass:"common_pagination_wrapper"},[a("el-pagination",{attrs:{"current-page":e.pagination.page,"page-size":e.pagination.limit,"page-sizes":[10,20,30,50,100],total:e.total,background:"",layout:"total, sizes, prev, pager, next, jumper",visible:e.oneKeyCrawlFlag,width:"850px"},on:{"update:currentPage":function(t){return e.$set(e.pagination,"page",t)},"update:current-page":function(t){return e.$set(e.pagination,"page",t)},"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange,"update:visible":function(t){e.oneKeyCrawlFlag=t}}})],1),a("el-dialog",{attrs:{title:"一件抓取",visible:e.oneKeyCrawlFlag,width:"1200px"},on:{"update:visible":function(t){e.oneKeyCrawlFlag=t}}},[a("el-row",{attrs:{justify:"center",type:"flex"}},[a("el-col",{attrs:{span:20}},[a("el-form",{ref:"formData",attrs:{model:e.formData,rules:e.rules,"label-position":"right"}},[a("el-form-item",{attrs:{label:"爬虫类型",prop:"rewardType"}},[a("el-select",{on:{change:e.chooseRewardType},model:{value:e.formData.rewardType,callback:function(t){e.$set(e.formData,"rewardType",t)},expression:"formData.rewardType"}},e._l(e.settingsList,(function(e,t){return a("el-option",{key:t})})),1)],1),a("el-form-item",{attrs:{label:"爬虫地址",prop:"crawlerAddress"}},[a("el-input",{model:{value:e.formData.crawlerAddress,callback:function(t){e.$set(e.formData,"crawlerAddress",t)},expression:"formData.crawlerAddress"}})],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],on:{click:function(t){e.oneKeyCrawlFlag=!1}}},[e._v(e._s(e.$t("table.cancel")))]),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"primary"},on:{click:e.crawlerData}},[e._v(e._s(e.$t("table.confirm")))])],1)],1),a("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.stepCrawlFlag,top:"1vh",width:"1400px"},on:{"update:visible":function(t){e.stepCrawlFlag=t}}},[a("el-row",{staticClass:"stepcrawlheader",attrs:{gutter:1}},[a("div",{staticClass:"left"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.prepareToCrawlFlag=!0}}},[e._v(" "+e._s(0===e.rankingListData.length?"获取索引":"重新获取索引")+" ")]),e.crawlingFlag?a("el-button",{attrs:{type:"danger"},on:{click:e.stopCrawling}},[e._v("停止抓取")]):a("el-button",{attrs:{disabled:0===e.rankingListData.length,type:"primary"},on:{click:e.beginToCrawRankingListMovieData}},[e._v(" "+e._s(0===e.crawlingCount?"开始抓取":"重新抓取")+" ")])],1),a("div",{staticClass:"right"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("保存")])],1)]),a("el-divider"),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-row",{attrs:{justify:"left",type:"flex"}},[a("el-col",{attrs:{span:14}},[a("el-input-number",{attrs:{min:0},model:{value:e.rankingListCountLimit,callback:function(t){e.rankingListCountLimit=t},expression:"rankingListCountLimit"}}),a("el-button",{attrs:{type:"primary"},on:{click:e.handleChangeCounter}},[e._v("确定")])],1),a("el-col",{attrs:{span:3}})],1),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-card",{attrs:{shadow:"never"}},[a("el-progress",{attrs:{percentage:0!==e.rankingListData.length?Math.floor(e.crawlingCount/e.rankingListData.length*100):0,"stroke-width":20,"text-inside":!0,status:"success"}}),a("el-divider",[a("el-row",[e.rankingListData.length>0&&e.crawlingCount<e.rankingListData.length?a("el-col",{attrs:{span:24}},[e._v(" 共有"+e._s(e.rankingListData.length)+"条数据，正在抓取第"+e._s(e.crawlingCount)+"条... ")]):a("el-col",{attrs:{span:24}},[e._v(" 共有"+e._s(e.rankingListData.length)+"条数据，抓取完毕 ")])],1)],1),a("el-row",{attrs:{justify:"left",type:"flex"}},[a("el-col",{attrs:{span:24}},[a("el-timeline",{style:e.crawlerStyle},e._l(e.rankingListData.filter((function(e){return!e.disabled})),(function(t,n){return a("el-timeline-item",{key:n,staticClass:"timelineitem",attrs:{color:"success"===t.color?"#91d929":"#e4e7ed",timestamp:t.recordTime,placement:"top"}},[a("el-card",{attrs:{shadow:"hover"}},[a("el-row",[a("el-col",{staticStyle:{"text-align":"left"},attrs:{span:1}},[e._v("第"+e._s(n+1)+"条")]),a("el-col",{staticStyle:{"text-align":"left"},attrs:{span:2}},[e._v(e._s(t.movieId))]),a("el-col",{staticStyle:{"text-align":"left"},attrs:{span:3}},[e._v(e._s(t.title))]),a("el-col",{attrs:{span:2}},[e._v(" 详情: "),0===t.detailSuccess?a("i",{}):1===t.detailSuccess?a("i",{staticClass:"el-icon-check success"}):2===t.detailSuccess?a("i",{staticClass:"el-icon-close failed"}):e._e()]),a("el-col",{attrs:{span:2}},[e._v(" 更多: "),0===t.moreSectionsSuccess?a("i",{}):1===t.moreSectionsSuccess?a("i",{staticClass:"el-icon-check success"}):2===t.moreSectionsSuccess?a("i",{staticClass:"el-icon-close failed"}):e._e()]),a("el-col",{attrs:{span:2}},[e._v(" 评分: "),0===t.rankingListRatingSuccess?a("i",{}):1===t.rankingListRatingSuccess?a("i",{staticClass:"el-icon-check success"}):2===t.rankingListRatingSuccess?a("i",{staticClass:"el-icon-close failed"}):e._e()]),a("el-col",{attrs:{span:2}},[e._v(" 想看: "),0===t.rankingListWantToSeePortraitSuccess?a("i",{}):1===t.rankingListWantToSeePortraitSuccess?a("i",{staticClass:"el-icon-check success"}):2===t.rankingListWantToSeePortraitSuccess?a("i",{staticClass:"el-icon-close failed"}):e._e()]),a("el-col",{attrs:{span:3}},[e._v(" 首映日票房: "),0===t.rankingListWantToSeePortraitSuccess?a("i",{}):1===t.rankingListWantToSeePortraitSuccess?a("i",{staticClass:"el-icon-check success"}):2===t.rankingListWantToSeePortraitSuccess?a("i",{staticClass:"el-icon-close failed"}):e._e()]),a("el-col",{attrs:{span:2}},[e._v(" 全球票房: "),0===t.rankingListBoxOfficeGlobalSuccess?a("i",{}):1===t.rankingListBoxOfficeGlobalSuccess?a("i",{staticClass:"el-icon-check success"}):2===t.rankingListBoxOfficeGlobalSuccess?a("i",{staticClass:"el-icon-close failed"}):e._e()])],1)],1)],1)})),1)],1)],1)],1)],1)],1)],1)],1),a("el-row",{attrs:{justify:"space-between",type:"flex"}},[a("el-col",{attrs:{span:21}}),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:3}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.stepCrawlFlag=!1}}},[e._v("关闭")])],1)],1)],1),a("el-dialog",{attrs:{visible:e.prepareToCrawlFlag,title:"准备爬取",width:"600px"},on:{"update:visible":function(t){e.prepareToCrawlFlag=t}}},[a("el-radio-group",{on:{change:e.handleChangeLimitType},model:{value:e.crawlerCountType,callback:function(t){e.crawlerCountType=t},expression:"crawlerCountType"}},[a("el-radio",{attrs:{label:0}},[e._v("全部")]),a("el-radio",{attrs:{label:1}},[e._v("部分")]),a("el-input-number",{attrs:{disabled:0===e.crawlerCountType,min:0},on:{change:e.handleChangeCountLimit},model:{value:e.rankingListCountLimit,callback:function(t){e.rankingListCountLimit=t},expression:"rankingListCountLimit"}})],1),a("el-button",{attrs:{type:"primary"},on:{click:e.getAllCrawlingIndex}},[e._v("开始抓取列表")])],1)],1)},i=[],r=a("1da1"),s=(a("d3b7"),a("a4d3"),a("e01a"),a("99af"),a("25f0"),a("d81d"),a("4de4"),a("159b"),a("b0c0"),a("3ca3"),a("ddb0"),a("96cf"),a("3b8a")),l={components:{CommonQuery:s["a"]},data:function(){var e=this;return{getListByPaginationRequest:"crawlerMaoyanRankingList/getListByPagination",crawlAndSaveRequest:"crawlerMaoyanRankingList/crawlAndSave",crawlRankinglistDetailRequest:"crawlerMaoyanRankingList/crawlRankinglistDetail",crawlRankingListMoreSectionsRequest:"crawlerMaoyanRankingList/crawlRankingListMoreSections",crawlRankingListRatingRequest:"crawlerMaoyanRankingList/crawlRankingListRating",crawlRankingListWantToSeePortraitRequest:"crawlerMaoyanRankingList/crawlRankingListWantToSeePortrait",crawlRankingListBoxOfficePremiereRequest:"crawlerMaoyanRankingList/crawlRankingListBoxOfficePremiere",crawlRankingListBoxOfficeGlobalRequest:"crawlerMaoyanRankingList/crawlRankingListBoxOfficeGlobal",crawlMoviePreSaleDetailRequest:"crawlerMaoyanPreSale/crawlMoviePreSaleDetail",crawlMoviePreSalePortraitRequest:"crawlerMaoyanPreSale/crawlMoviePreSalePortrait",deleteRecordRequest:"crawlerMaoyanRankingList/deleteRecords",getSettingsRequest:"settings/getList",crawlRankingListByYearRequest:"crawlerMaoyanRankingList/crawlRankingListByYear",crawlPreSaleMovieListRequest:"crawlerMaoyanPreSale/crawlMovieList",saveMultipleMaoyanRankingListRecordRequest:"crawlerMaoyanRankingList/saveMultipleMaoyanRankingListRecord",crawlerSettingFlag:!1,crawlerSetting:{address:""},chosenReward:"",chooseRewardTypeModel:{},chosenThirdPartyProductInfo:{},value2:"",value1:"",dailyLimitMode:"",limitMode:"",tableKey:0,tableList:[],total:null,listLoading:!0,availabilityFlag:!1,prepareToCrawlFlag:!1,crawlerCountType:0,statusDictionary:[{code:0,name:"未上线"},{code:1,name:"上线"}],queryModel:{sort:"desc",brandName:""},pagination:{page:1,limit:100},importanceOptions:[1,2,3],sortOptions:[{label:"ID Ascending",key:"+id"},{label:"ID Descending",key:"-id"}],statusOptions:["published","draft","deleted"],showReviewer:!1,formData:{headerCode:"maoyan",crawlerAddress:""},dialogFormVisible:!1,dialogStatus:"",textMap:{update:"Edit",create:"Create"},dialogPvVisible:!1,rules:{id:[{required:!0,message:"此项为必填项",trigger:"change"}],description:[{required:!0,message:"此项为必填项",trigger:"change"}],name:[{required:!0,message:"此项为必填项",trigger:"change"}],dailyLimit:[{required:!0,message:"此项为必填项",trigger:"change"}],limit:[{required:!0,message:"此项为必填项",trigger:"change"}],startDate:[{required:!0,message:"此项为必填项",trigger:"change"}],endDate:[{required:!0,message:"此项为必填项",trigger:"change"}],status:[{required:!0,message:"此项为必填项",trigger:"change"}]},downloadLoading:!1,pickerOptions0:{disabledDate:function(t){if(""!==e.value2)return t.getTime()>e.value2}},pickerOptions1:{disabledDate:function(t){return t.getTime()<e.value1}},fileList:[],portraitParams:{bucketName:"funyvalley",folderName:"icon"},iosVersionListData:[],androidVersionListData:[],searchTxt:"",expandQuery:"",showFileListFlag:!1,newFile:"",advertisementDialogFlag:!1,currentAdvertisementTabIndex:0,effectiveDuration:[],multipleSelection:[],oneKeyCrawlFlag:!1,stepCrawlFlag:!1,settingsList:[],rankingListMovieData:[],rankingListData:[],crawlingCount:0,preSaleWantToSeeListData:[],preSaleWantToSeeListMovieData:[],crawlingFlag:!1,rankingListCountLimit:0,presaleCountLimit:0}},computed:{tableHeight:function(){return this.$store.state.app.tableHeight},dictionaryList:function(){return this.$store.state.app.dictionary.crawlerAddress},crawlerStyle:function(){return{height:this.tableHeight-180+"px",overflow:"auto"}}},watch:{effectiveDuration:function(e){console.log(e),null===e&&(e=[]),this.formData.startDate=this.$moment(e[0]).format("YYYY-MM-DD"),this.formData.endDate=this.$moment(e[1]).format("YYYY-MM-DD")},currentAdvertisementTabIndex:function(e){console.log(e)}},mounted:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getSettingsDictionary();case 2:e.settingsList=t.sent,e.getTableData();case 4:case"end":return t.stop()}}),t)})))()},methods:{getTableData:function(){var e=this;this.listLoading=!0,this.$http.get(this.$baseUrl+this.getListByPaginationRequest,{params:Object.assign(this.queryModel,this.pagination)}).then((function(t){console.log("getListByPaginationRequest",t),e.tableList=t.data,e.total=t.pagination.total,e.listLoading=!1}))},getSettingsDictionary:function(){var e=this;return new Promise((function(t,a){e.$http.get(e.$baseUrl+e.getSettingsRequest,{params:{type:"crawlerAddress"}}).then((function(e){t(e.data)})).catch((function(e){console.log(e),a(e)}))}))},handleFilter:function(){this.pagination.page=1,this.getTableData()},handleSizeChange:function(e){this.pagination.limit=e,this.getTableData()},handleCurrentChange:function(e){this.pagination.page=e,this.getTableData()},resetTemp:function(){this.formData={id:"",description:"",rewardImage:"",rewardName:"",rewardPrompt:"",rewardStr:"",rewardType:"",rewardValue:"",status:""}},crawlerData:function(){var e=this;this.$http.post(this.$baseUrl+this.crawlAndSaveRequest,{address:this.formData.crawlerAddress,headerCode:this.formData.headerCode}).then((function(t){console.log(t),e.$message.success("抓取成功"),e.getTableData(),e.oneKeyCrawlFlag=!1}))},createData:function(){this.formData.id="",this.updateData()},handleUpdate:function(e){var t=this;console.log(e),this.formData=Object.assign({},e.row),this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick((function(){t.$refs["formData"].clearValidate()}))},updateData:function(){var e=this;this.$refs["formData"].validate((function(t){t&&e.$http.post(e.$baseUrl+e.addAndUpdateRewardInfoRequest,{id:e.formData.id,description:e.formData.description,rewardImage:e.formData.rewardImage,rewardName:e.formData.rewardName,rewardPrompt:e.formData.rewardPrompt,rewardStr:e.formData.rewardStr,rewardType:e.formData.rewardType,rewardValue:e.formData.rewardValue,status:e.formData.status}).then((function(t){console.log(t),e.dialogFormVisible=!1,e.$message.success("信息修改成功"),e.getTableData()})).catch((function(t){console.log(t),e.$message.error("".concat(t.response.status.toString(),"  ").concat(t.response.data.error))}))}))},handleSelectionChange:function(e){this.multipleSelection=e,console.log(e)},handleMultipleDelete:function(){var e=this;this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.deleteRecord(e.multipleSelection.map((function(e){return e.id})))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},handleDelete:function(e){var t=this;console.log(e),this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.deleteRecord([e.row.id])})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},deleteRecord:function(e){var t=this;this.$http.delete(this.$baseUrl+this.deleteRecordRequest,{data:{id:e}}).then((function(e){console.log(e),t.dialogFormVisible=!1,t.$message.success("删除成功"),t.getTableData()})).catch((function(e){console.log(e),t.$message.error("".concat(e.response.status.toString(),"  ").concat(e.response.data.error))}))},expand:function(){this.expandQuery=!this.expandQuery},search:function(){this.getTableData()},reset:function(){this.queryModel.available=!0},uploadSuccess1:function(e){console.log(e),this.formData.icon=e.url},uploadSuccess2:function(e){this.formData.rewardImage=e.url},changeDailyLimitMode:function(e){this.formData.dailyLimit="unlimited"===e.toString()?"-1":this.formData.dailyLimit},changeLimitMode:function(e){this.formData.limit="unlimited"===e.toString()?"-1":this.formData.limit,alert(this.formData.limit)},chooseRewardType:function(e){this.formData.type=this.settingsList.filter((function(t){return t.value===e}))[0].code,this.formData.crawlerAddress=e},chooseThirdPartyProduct:function(e){this.chosenThirdPartyProductInfo=e},confirmCrawlerSetting:function(){this.crawlerSettingFlag=!1,this.$message.success("设置成功")},focusSortList:function(e,t){var a=this;this.loading=!0,this.$http.get(this.$baseUrl+this.queryRewardProductByNameRequest,{params:{name:this.chosenReward}}).then((function(e){console.log(e),a.loading=!1;var n=[];0!==e.data.length&&(e.data.forEach((function(e,t){n.push(Object.assign(e,{value:e.name}))})),console.log(111,n),t(n))}))},getAllCrawlingIndex:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getRankingList();case 2:e.prepareToCrawlFlag=!1;case 3:case"end":return t.stop()}}),t)})))()},getMovieData:function(){var e=this,t=this.getDetailData();Promise.all([t]).then((function(e){console.log(e)})).catch((function(t){console.log(t),e.$message.error(t)}))},getDetailData:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,a){e.$http.get(e.$baseUrl+e.crawlPreSaleMovieListRequest,{params:{address:"https://piaofang.maoyan.com/store",headerCode:"maoyanPreSale"}}).then((function(a){console.log(a),e.presaleCountLimit=a.data.length,e.preSaleWantToSeeListData=a.data,a.data.forEach((function(t,a){a<e.presaleCountLimit&&e.$set(e.preSaleWantToSeeListData,a,Object.assign(t,{detailSuccess:0,content:["detailSuccess","rankingListWantToSeePortraitSuccess"],color:"sunccess",recordTime:"---",active:!0}))})),e.$message.success("获取预售列表成功"),t(e.preSaleWantToSeeListData)})).catch((function(t){e.$message.error(t),a(t)}))})));case 1:case"end":return t.stop()}}),t)})))()},getPreSaleList:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$http.get(e.$baseUrl+e.crawlPreSaleMovieListRequest,{params:{address:"https://piaofang.maoyan.com/store",headerCode:"maoyanPreSale"}}).then((function(t){console.log(t),e.presaleCountLimit=t.data.length,e.preSaleWantToSeeListData=t.data,e.preSaleWantToSeeListData.forEach((function(t,a){a<e.presaleCountLimit&&e.$set(e.preSaleWantToSeeListData,a,Object.assign(t,{preSaleWantToSeePortraitSuccess:0,content:"detailSuccesspreSaleWantToSeePortraitSuccess",color:"sunccess",recordTime:"---",active:!0}))})),e.$message.success("获取预售列表成功")})).catch((function(t){e.$message.error(t)}));case 1:case"end":return t.stop()}}),t)})))()},getRankingList:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,a){e.$http.post(e.$baseUrl+e.crawlRankingListByYearRequest,{address:"https://piaofang.maoyan.com/rankings/year",headerCode:"maoyanRankingList",limit:e.rankingListCountLimit,query:{year:"2019",tab:"1"}},{timeout:2e4}).then((function(a){e.rankingListCountLimit=a.data.length,console.log(a);var n=a.data.map((function(e){return Object.assign(e,{title:e.title,detailSuccess:0,rankingListRatingSuccess:0,rankingListWantToSeePortraitSuccess:0,moreSectionsSuccess:0,rankingListBoxOfficeGlobalSuccess:0,content:"detailSuccessrankingListWantToSeePortraitSuccess",color:"sunccess",recordTime:"---",active:!0})}));t(e.rankingListData),e.$message.success("获取电影排名列表成功"),e.rankingListData=n})).catch((function(t){e.$message.error(t),a(t)}))})));case 1:case"end":return t.stop()}}),t)})))()},beginToCrawRankingListMovieData:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.crawlingCount=0,e.rankingListMovieData=[],[],a={},!1,!1,n=function t(){var n=e.crawlingCount;e.crawlingFlag=!0,console.log(e.rankingListData);var i=e.rankingListData[n].movieId,r=function(){return new Promise((function(t,r){e.$http.get(e.$baseUrl+e.crawlRankinglistDetailRequest,{params:{address:"https://piaofang.maoyan.com/movie/"+i,headerCode:"rankingListDetailHeader"},timeout:2e4}).then((function(r){a.detail=r.data,r.data=Object.assign({movieId:i},r.data),e.$set(e.rankingListData,n,Object.assign(e.rankingListData[n],{detailSuccess:1})),t(r.data)})).catch((function(a){e.$set(e.rankingListData,n,Object.assign(e.rankingListData[n],{detailSuccess:2})),t(a)}))}))},s=function(){return new Promise((function(t,r){e.$http.get(e.$baseUrl+e.crawlRankingListMoreSectionsRequest,{params:{address:"https://piaofang.maoyan.com/movie/"+i+"/moresections",headerCode:"rankingListDetailHeader"}}).then((function(i){a.detailMoreSections=i.data,e.$set(e.rankingListData,n,Object.assign(e.rankingListData[n],{moreSectionsSuccess:1})),t(i.data)})).catch((function(a){e.$set(e.rankingListData,n,Object.assign(e.rankingListData[n],{moreSectionsSuccess:2})),t(a)}))}))},l=function(){return new Promise((function(t,r){e.$http.get(e.$baseUrl+e.crawlRankingListWantToSeePortraitRequest,{params:{address:"https://piaofang.maoyan.com/movie/"+i+"/wantindex?wkwebview=1%26city_tier=0%26city_id=0%26cityName=%E5%85%A8%E5%9B%BD",headerCode:"rankingListDetailHeader"},timeout:2e4}).then((function(i){a.portrait=i.data,console.log("getRankingListWantToSeePortrait",i.data),e.$set(e.rankingListData,n,Object.assign(e.rankingListData[n],{rankingListWantToSeePortraitSuccess:1})),t(i.data)})).catch((function(a){e.$set(e.rankingListData,n,Object.assign(e.rankingListData[n],{rankingListWantToSeePortraitSuccess:2})),t(a)}))}))},o=function(){return new Promise((function(t,r){e.$http.get(e.$baseUrl+e.crawlRankingListRatingRequest,{params:{address:"https://piaofang.maoyan.com/movie/"+i+"/audienceRating?usePageCache=true",headerCode:"rankingListDetailHeader"},timeout:3e5}).then((function(i){a.rating=i.data,e.$set(e.rankingListData,n,Object.assign(e.rankingListData[n],{rankingListRatingSuccess:1})),t(i.data)})).catch((function(a){e.$set(e.rankingListData,n,Object.assign(e.rankingListData[n],{rankingListRatingSuccess:2})),t(a)}))}))},c=function(){return new Promise((function(t,r){e.$http.get(e.$baseUrl+e.crawlRankingListBoxOfficePremiereRequest,{params:{address:"https://piaofang.maoyan.com/movie/"+i+"/premierebox",headerCode:"rankingListDetailHeader"},timeout:3e5}).then((function(i){a.rating=i.data,e.$set(e.rankingListData,n,Object.assign(e.rankingListData[n],{RankingListPemiereBoxSuccess:1})),t(i.data)})).catch((function(a){e.$set(e.rankingListData,n,Object.assign(e.rankingListData[n],{RankingListPemiereBoxSuccess:2})),t(a)}))}))},g=function(){return new Promise((function(t,r){e.$http.get(e.$baseUrl+e.crawlRankingListBoxOfficeGlobalRequest,{params:{address:"https://piaofang.maoyan.com/movie/"+i+"/boxshowna",headerCode:"rankingListDetailHeader"},timeout:3e5}).then((function(i){a.rating=i.data,e.$set(e.rankingListData,n,Object.assign(e.rankingListData[n],{rankingListBoxOfficeGlobalSuccess:1})),t(i.data)})).catch((function(a){e.$set(e.rankingListData,n,Object.assign(e.rankingListData[n],{rankingListBoxOfficeGlobalSuccess:2})),t(a)}))}))},u=r(),p=l(),d=o(),m=s(),f=c(),h=g();Promise.all([u,m,d,p,f,h]).then((function(a){console.log("responseAll",a),e.rankingListData[n].color="success",e.$set(e.rankingListMovieData,n,Object.assign(a[0],a[1],a[2],a[3],a[4],a[5])),console.log("rankingListMovieData",e.rankingListMovieData),e.crawlingCount===e.rankingListCountLimit?(e.crawlingFlag=!1,e.crawlingCount=0):e.crawlingCount++,e.crawlingFlag&&(e.rankingListData[n].recordTime=e.$moment(Date.now()).format("hh:mm:ss"),t())})).catch((function(a){console.log(a),e.crawlingCount===e.rankingListData.length?e.crawlingFlag=!1:e.crawlingCount++,e.crawlingFlag&&t()}))},n();case 8:case"end":return t.stop()}}),t)})))()},beginToCrawlPreSale:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.crawlingCount=0,e.preSaleWantToSeeListData=[],[],a={},!1,!1,n=function t(){var n=e.crawlingCount;e.crawlingFlag=!0;var i=e.preSaleWantToSeeListData[n].movieId,r=function(){return new Promise((function(t,r){e.$http.get(e.$baseUrl+e.crawlMoviePreSaleDetailRequest,{params:{address:"https://piaofang.maoyan.com/movie/"+i,headerCode:"maoyanPreSale"}}).then((function(i){a.detail=i.data,e.$set(e.preSaleWantToSeeListData,n,Object.assign(e.preSaleWantToSeeListData[n],{detailSuccess:1})),t(i.data)})).catch((function(t){e.$set(e.preSaleWantToSeeListData,n,Object.assign(e.preSaleWantToSeeListData[n],{detailSuccess:2})),r(t)}))}))},s=function(){return new Promise((function(t,r){e.$http.get(e.$baseUrl+e.crawlMoviePreSalePortraitRequest,{params:{address:"https://piaofang.maoyan.com/movie/"+i+"/wantindex?wkwebview=1%26city_tier=0%26city_id=0%26cityName=%E5%85%A8%E5%9B%BD",headerCode:"rankingListDetailHeader"}}).then((function(i){a.portrait=i.data,e.$set(e.preSaleWantToSeeListData,n,Object.assign(e.preSaleWantToSeeListData[n],{rankingListWantToSeePortraitSuccess:1,color:"success"})),t(i.data)})).catch((function(t){e.$set(e.preSaleWantToSeeListData,n,Object.assign(e.preSaleWantToSeeListData[n],{rankingListWantToSeePortraitSuccess:2,color:"failed"})),r(t)}))}))},l=r(),o=s();e.crawlingCount===e.rankingListCountLimit?e.crawlingFlag=!1:e.crawlingCount++,Promise.all([l,o]).then((function(a){console.log(a),e.$set(e.preSaleWantToSeeListData,n,Object.assign(a[0],a[1])),console.log("rankingListMovieData",e.preSaleWantToSeeListData),e.crawlingFlag&&(e.preSaleWantToSeeListData[n].recordTime=e.$moment(Date.now()).format("hh:mm:ss"),t())})).catch((function(a){console.log(a),e.crawlingCount===e.rankingListCountLimit?e.crawlingFlag=!1:e.crawlingCount++,e.crawlingFlag&&t()}))},n();case 8:case"end":return t.stop()}}),t)})))()},stopCrawling:function(){this.crawlingFlag=!1},handleSave:function(){var e=this;0!==this.crawlingCount&&this.crawlingCount===this.rankingListCountLimit?(console.log(this.rankingListMovieData),this.$http.post(this.$baseUrl+this.saveMultipleMaoyanRankingListRecordRequest,this.rankingListMovieData).then((function(t){e.$message.success("数据提交成功"),e.getTableData(),e.stepCrawlFlag=!1})).catch((function(e){console.log(e)}))):this.$message.warning("dsdsdsdsds")},handleChangeCounter:function(e){var t=this;this.preSaleWantToSeeListData.forEach((function(e,a){t.$set(t.preSaleWantToSeeListData,a,Object.assign(t.preSaleWantToSeeListData[a],{active:a<t.rankingListCountLimit}))}))},checkDescription:function(e){this.$alert(e.row.description,"电影描述",{confirmButtonText:"关闭",closeOnClickModal:!0,callback:function(e){}})},handleChangeLimitType:function(e){console.log(this.crawlerCountType),0===this.crawlerCountType&&(this.rankingListCountLimit=0)},handleChangeCountLimit:function(){}}},o=l,c=(a("b1c8"),a("2877")),g=Object(c["a"])(o,n,i,!1,null,null,null);t["default"]=g.exports},b1c8:function(e,t,a){"use strict";a("e132")},e132:function(e,t,a){}}]);
//# sourceMappingURL=chunk-5ced5d2e.9bc33377.js.map